{"version":3,"file":"index.js","mappings":"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","sources":["webpack://clipforge/./node_modules/fluent-ffmpeg/lib/options/output.js","webpack://clipforge/external node-commonjs \"tty\"","webpack://clipforge/external node-commonjs \"util\"","webpack://clipforge/./node_modules/electron-squirrel-startup/node_modules/debug/src/index.js","webpack://clipforge/./node_modules/fluent-ffmpeg/index.js","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/fluent-ffmpeg.js","webpack://clipforge/external node-commonjs \"electron\"","webpack://clipforge/external node-commonjs \"stream\"","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/options/custom.js","webpack://clipforge/external node-commonjs \"net\"","webpack://clipforge/external node-commonjs \"child_process\"","webpack://clipforge/./electron/utils/ffmpegPath.js","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/options/videosize.js","webpack://clipforge/external node-commonjs \"events\"","webpack://clipforge/./node_modules/electron-squirrel-startup/node_modules/debug/src/node.js","webpack://clipforge/./node_modules/electron-squirrel-startup/node_modules/debug/src/browser.js","webpack://clipforge/./node_modules/electron-squirrel-startup/node_modules/ms/index.js","webpack://clipforge/./node_modules/electron-squirrel-startup/node_modules/debug/src/debug.js","webpack://clipforge/./node_modules/async/lib/async.js","webpack://clipforge/./node_modules/isexe/mode.js","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/options/video.js","webpack://clipforge/./node_modules/fluent-ffmpeg/node_modules/which/which.js","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/ffprobe.js","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/capabilities.js","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/utils.js","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/processor.js","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/options/inputs.js","webpack://clipforge/external node-commonjs \"node:path\"","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/options/misc.js","webpack://clipforge/./node_modules/isexe/index.js","webpack://clipforge/./node_modules/isexe/windows.js","webpack://clipforge/external node-commonjs \"os\"","webpack://clipforge/external node-commonjs \"fs\"","webpack://clipforge/external node-commonjs \"path\"","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/recipes.js","webpack://clipforge/./node_modules/fluent-ffmpeg/lib/options/audio.js","webpack://clipforge/./node_modules/electron-squirrel-startup/index.js","webpack://clipforge/webpack/bootstrap","webpack://clipforge/webpack/runtime/compat","webpack://clipforge/./src/main.js"],"sourcesContent":["/*jshint node:true*/\n'use strict';\n\nvar utils = require('../utils');\n\n\n/*\n *! Output-related methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Add output\n   *\n   * @method FfmpegCommand#output\n   * @category Output\n   * @aliases addOutput\n   *\n   * @param {String|Writable} target target file path or writable stream\n   * @param {Object} [pipeopts={}] pipe options (only applies to streams)\n   * @return FfmpegCommand\n   */\n  proto.addOutput =\n  proto.output = function(target, pipeopts) {\n    var isFile = false;\n\n    if (!target && this._currentOutput) {\n      // No target is only allowed when called from constructor\n      throw new Error('Invalid output');\n    }\n\n    if (target && typeof target !== 'string') {\n      if (!('writable' in target) || !(target.writable)) {\n        throw new Error('Invalid output');\n      }\n    } else if (typeof target === 'string') {\n      var protocol = target.match(/^([a-z]{2,}):/i);\n      isFile = !protocol || protocol[0] === 'file';\n    }\n\n    if (target && !('target' in this._currentOutput)) {\n      // For backwards compatibility, set target for first output\n      this._currentOutput.target = target;\n      this._currentOutput.isFile = isFile;\n      this._currentOutput.pipeopts = pipeopts || {};\n    } else {\n      if (target && typeof target !== 'string') {\n        var hasOutputStream = this._outputs.some(function(output) {\n          return typeof output.target !== 'string';\n        });\n\n        if (hasOutputStream) {\n          throw new Error('Only one output stream is supported');\n        }\n      }\n\n      this._outputs.push(this._currentOutput = {\n        target: target,\n        isFile: isFile,\n        flags: {},\n        pipeopts: pipeopts || {}\n      });\n\n      var self = this;\n      ['audio', 'audioFilters', 'video', 'videoFilters', 'sizeFilters', 'options'].forEach(function(key) {\n        self._currentOutput[key] = utils.args();\n      });\n\n      if (!target) {\n        // Call from constructor: remove target key\n        delete this._currentOutput.target;\n      }\n    }\n\n    return this;\n  };\n\n\n  /**\n   * Specify output seek time\n   *\n   * @method FfmpegCommand#seek\n   * @category Input\n   * @aliases seekOutput\n   *\n   * @param {String|Number} seek seek time in seconds or as a '[hh:[mm:]]ss[.xxx]' string\n   * @return FfmpegCommand\n   */\n  proto.seekOutput =\n  proto.seek = function(seek) {\n    this._currentOutput.options('-ss', seek);\n    return this;\n  };\n\n\n  /**\n   * Set output duration\n   *\n   * @method FfmpegCommand#duration\n   * @category Output\n   * @aliases withDuration,setDuration\n   *\n   * @param {String|Number} duration duration in seconds or as a '[[hh:]mm:]ss[.xxx]' string\n   * @return FfmpegCommand\n   */\n  proto.withDuration =\n  proto.setDuration =\n  proto.duration = function(duration) {\n    this._currentOutput.options('-t', duration);\n    return this;\n  };\n\n\n  /**\n   * Set output format\n   *\n   * @method FfmpegCommand#format\n   * @category Output\n   * @aliases toFormat,withOutputFormat,outputFormat\n   *\n   * @param {String} format output format name\n   * @return FfmpegCommand\n   */\n  proto.toFormat =\n  proto.withOutputFormat =\n  proto.outputFormat =\n  proto.format = function(format) {\n    this._currentOutput.options('-f', format);\n    return this;\n  };\n\n\n  /**\n   * Add stream mapping to output\n   *\n   * @method FfmpegCommand#map\n   * @category Output\n   *\n   * @param {String} spec stream specification string, with optional square brackets\n   * @return FfmpegCommand\n   */\n  proto.map = function(spec) {\n    this._currentOutput.options('-map', spec.replace(utils.streamRegexp, '[$1]'));\n    return this;\n  };\n\n\n  /**\n   * Run flvtool2/flvmeta on output\n   *\n   * @method FfmpegCommand#flvmeta\n   * @category Output\n   * @aliases updateFlvMetadata\n   *\n   * @return FfmpegCommand\n   */\n  proto.updateFlvMetadata =\n  proto.flvmeta = function() {\n    this._currentOutput.flags.flvmeta = true;\n    return this;\n  };\n};\n","module.exports = require(\"tty\");","module.exports = require(\"util\");","/**\n * Detect Electron renderer process, which is node, but we should\n * treat as a browser.\n */\n\nif (typeof process !== 'undefined' && process.type === 'renderer') {\n  module.exports = require('./browser.js');\n} else {\n  module.exports = require('./node.js');\n}\n","module.exports = require('./lib/fluent-ffmpeg');\n",null,"module.exports = require(\"electron\");","module.exports = require(\"stream\");","/*jshint node:true*/\n'use strict';\n\nvar utils = require('../utils');\n\n\n/*\n *! Custom options methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Add custom input option(s)\n   *\n   * When passing a single string or an array, each string containing two\n   * words is split (eg. inputOptions('-option value') is supported) for\n   * compatibility reasons.  This is not the case when passing more than\n   * one argument.\n   *\n   * @example\n   * command.inputOptions('option1');\n   *\n   * @example\n   * command.inputOptions('option1', 'option2');\n   *\n   * @example\n   * command.inputOptions(['option1', 'option2']);\n   *\n   * @method FfmpegCommand#inputOptions\n   * @category Custom options\n   * @aliases addInputOption,addInputOptions,withInputOption,withInputOptions,inputOption\n   *\n   * @param {...String} options option string(s) or string array\n   * @return FfmpegCommand\n   */\n  proto.addInputOption =\n  proto.addInputOptions =\n  proto.withInputOption =\n  proto.withInputOptions =\n  proto.inputOption =\n  proto.inputOptions = function(options) {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    var doSplit = true;\n\n    if (arguments.length > 1) {\n      options = [].slice.call(arguments);\n      doSplit = false;\n    }\n\n    if (!Array.isArray(options)) {\n      options = [options];\n    }\n\n    this._currentInput.options(options.reduce(function(options, option) {\n      var split = String(option).split(' ');\n\n      if (doSplit && split.length === 2) {\n        options.push(split[0], split[1]);\n      } else {\n        options.push(option);\n      }\n\n      return options;\n    }, []));\n    return this;\n  };\n\n\n  /**\n   * Add custom output option(s)\n   *\n   * @example\n   * command.outputOptions('option1');\n   *\n   * @example\n   * command.outputOptions('option1', 'option2');\n   *\n   * @example\n   * command.outputOptions(['option1', 'option2']);\n   *\n   * @method FfmpegCommand#outputOptions\n   * @category Custom options\n   * @aliases addOutputOption,addOutputOptions,addOption,addOptions,withOutputOption,withOutputOptions,withOption,withOptions,outputOption\n   *\n   * @param {...String} options option string(s) or string array\n   * @return FfmpegCommand\n   */\n  proto.addOutputOption =\n  proto.addOutputOptions =\n  proto.addOption =\n  proto.addOptions =\n  proto.withOutputOption =\n  proto.withOutputOptions =\n  proto.withOption =\n  proto.withOptions =\n  proto.outputOption =\n  proto.outputOptions = function(options) {\n    var doSplit = true;\n\n    if (arguments.length > 1) {\n      options = [].slice.call(arguments);\n      doSplit = false;\n    }\n\n    if (!Array.isArray(options)) {\n      options = [options];\n    }\n\n    this._currentOutput.options(options.reduce(function(options, option) {\n      var split = String(option).split(' ');\n\n      if (doSplit && split.length === 2) {\n        options.push(split[0], split[1]);\n      } else {\n        options.push(option);\n      }\n\n      return options;\n    }, []));\n    return this;\n  };\n\n\n  /**\n   * Specify a complex filtergraph\n   *\n   * Calling this method will override any previously set filtergraph, but you can set\n   * as many filters as needed in one call.\n   *\n   * @example <caption>Overlay an image over a video (using a filtergraph string)</caption>\n   *   ffmpeg()\n   *     .input('video.avi')\n   *     .input('image.png')\n   *     .complexFilter('[0:v][1:v]overlay[out]', ['out']);\n   *\n   * @example <caption>Overlay an image over a video (using a filter array)</caption>\n   *   ffmpeg()\n   *     .input('video.avi')\n   *     .input('image.png')\n   *     .complexFilter([{\n   *       filter: 'overlay',\n   *       inputs: ['0:v', '1:v'],\n   *       outputs: ['out']\n   *     }], ['out']);\n   *\n   * @example <caption>Split video into RGB channels and output a 3x1 video with channels side to side</caption>\n   *  ffmpeg()\n   *    .input('video.avi')\n   *    .complexFilter([\n   *      // Duplicate video stream 3 times into streams a, b, and c\n   *      { filter: 'split', options: '3', outputs: ['a', 'b', 'c'] },\n   *\n   *      // Create stream 'red' by cancelling green and blue channels from stream 'a'\n   *      { filter: 'lutrgb', options: { g: 0, b: 0 }, inputs: 'a', outputs: 'red' },\n   *\n   *      // Create stream 'green' by cancelling red and blue channels from stream 'b'\n   *      { filter: 'lutrgb', options: { r: 0, b: 0 }, inputs: 'b', outputs: 'green' },\n   *\n   *      // Create stream 'blue' by cancelling red and green channels from stream 'c'\n   *      { filter: 'lutrgb', options: { r: 0, g: 0 }, inputs: 'c', outputs: 'blue' },\n   *\n   *      // Pad stream 'red' to 3x width, keeping the video on the left, and name output 'padded'\n   *      { filter: 'pad', options: { w: 'iw*3', h: 'ih' }, inputs: 'red', outputs: 'padded' },\n   *\n   *      // Overlay 'green' onto 'padded', moving it to the center, and name output 'redgreen'\n   *      { filter: 'overlay', options: { x: 'w', y: 0 }, inputs: ['padded', 'green'], outputs: 'redgreen'},\n   *\n   *      // Overlay 'blue' onto 'redgreen', moving it to the right\n   *      { filter: 'overlay', options: { x: '2*w', y: 0 }, inputs: ['redgreen', 'blue']},\n   *    ]);\n   *\n   * @method FfmpegCommand#complexFilter\n   * @category Custom options\n   * @aliases filterGraph\n   *\n   * @param {String|Array} spec filtergraph string or array of filter specification\n   *   objects, each having the following properties:\n   * @param {String} spec.filter filter name\n   * @param {String|Array} [spec.inputs] (array of) input stream specifier(s) for the filter,\n   *   defaults to ffmpeg automatically choosing the first unused matching streams\n   * @param {String|Array} [spec.outputs] (array of) output stream specifier(s) for the filter,\n   *   defaults to ffmpeg automatically assigning the output to the output file\n   * @param {Object|String|Array} [spec.options] filter options, can be omitted to not set any options\n   * @param {Array} [map] (array of) stream specifier(s) from the graph to include in\n   *   ffmpeg output, defaults to ffmpeg automatically choosing the first matching streams.\n   * @return FfmpegCommand\n   */\n  proto.filterGraph =\n  proto.complexFilter = function(spec, map) {\n    this._complexFilters.clear();\n\n    if (!Array.isArray(spec)) {\n      spec = [spec];\n    }\n\n    this._complexFilters('-filter_complex', utils.makeFilterStrings(spec).join(';'));\n\n    if (Array.isArray(map)) {\n      var self = this;\n      map.forEach(function(streamSpec) {\n        self._complexFilters('-map', streamSpec.replace(utils.streamRegexp, '[$1]'));\n      });\n    } else if (typeof map === 'string') {\n      this._complexFilters('-map', map.replace(utils.streamRegexp, '[$1]'));\n    }\n\n    return this;\n  };\n};\n","module.exports = require(\"net\");","module.exports = require(\"child_process\");","const path = require('path');\nconst { app } = require('electron');\nconst os = require('os');\n\nfunction getFFmpegPath() {\n  if (process.env.NODE_ENV === 'development') {\n    // Use system FFmpeg in dev (assumes brew install ffmpeg)\n    return 'ffmpeg';\n  }\n  \n  // Production: use bundled FFmpeg\n  const arch = os.arch(); // 'arm64' or 'x64'\n  const platform = os.platform(); // 'darwin'\n  const resourcesPath = process.resourcesPath;\n  \n  return path.join(\n    resourcesPath,\n    'ffmpeg',\n    `${platform}-${arch}`,\n    'ffmpeg'\n  );\n}\n\nfunction getFFprobePath() {\n  if (process.env.NODE_ENV === 'development') {\n    return 'ffprobe';\n  }\n  \n  const arch = os.arch();\n  const platform = os.platform();\n  const resourcesPath = process.resourcesPath;\n  \n  return path.join(\n    resourcesPath,\n    'ffmpeg',\n    `${platform}-${arch}`,\n    'ffprobe'\n  );\n}\n\nmodule.exports = { getFFmpegPath, getFFprobePath };\n","/*jshint node:true*/\n'use strict';\n\n/*\n *! Size helpers\n */\n\n\n/**\n * Return filters to pad video to width*height,\n *\n * @param {Number} width output width\n * @param {Number} height output height\n * @param {Number} aspect video aspect ratio (without padding)\n * @param {Number} color padding color\n * @return scale/pad filters\n * @private\n */\nfunction getScalePadFilters(width, height, aspect, color) {\n  /*\n    let a be the input aspect ratio, A be the requested aspect ratio\n\n    if a > A, padding is done on top and bottom\n    if a < A, padding is done on left and right\n   */\n\n  return [\n    /*\n      In both cases, we first have to scale the input to match the requested size.\n      When using computed width/height, we truncate them to multiples of 2\n     */\n    {\n      filter: 'scale',\n      options: {\n        w: 'if(gt(a,' + aspect + '),' + width + ',trunc(' + height + '*a/2)*2)',\n        h: 'if(lt(a,' + aspect + '),' + height + ',trunc(' + width + '/a/2)*2)'\n      }\n    },\n\n    /*\n      Then we pad the scaled input to match the target size\n      (here iw and ih refer to the padding input, i.e the scaled output)\n     */\n\n    {\n      filter: 'pad',\n      options: {\n        w: width,\n        h: height,\n        x: 'if(gt(a,' + aspect + '),0,(' + width + '-iw)/2)',\n        y: 'if(lt(a,' + aspect + '),0,(' + height + '-ih)/2)',\n        color: color\n      }\n    }\n  ];\n}\n\n\n/**\n * Recompute size filters\n *\n * @param {Object} output\n * @param {String} key newly-added parameter name ('size', 'aspect' or 'pad')\n * @param {String} value newly-added parameter value\n * @return filter string array\n * @private\n */\nfunction createSizeFilters(output, key, value) {\n  // Store parameters\n  var data = output.sizeData = output.sizeData || {};\n  data[key] = value;\n\n  if (!('size' in data)) {\n    // No size requested, keep original size\n    return [];\n  }\n\n  // Try to match the different size string formats\n  var fixedSize = data.size.match(/([0-9]+)x([0-9]+)/);\n  var fixedWidth = data.size.match(/([0-9]+)x\\?/);\n  var fixedHeight = data.size.match(/\\?x([0-9]+)/);\n  var percentRatio = data.size.match(/\\b([0-9]{1,3})%/);\n  var width, height, aspect;\n\n  if (percentRatio) {\n    var ratio = Number(percentRatio[1]) / 100;\n    return [{\n      filter: 'scale',\n      options: {\n        w: 'trunc(iw*' + ratio + '/2)*2',\n        h: 'trunc(ih*' + ratio + '/2)*2'\n      }\n    }];\n  } else if (fixedSize) {\n    // Round target size to multiples of 2\n    width = Math.round(Number(fixedSize[1]) / 2) * 2;\n    height = Math.round(Number(fixedSize[2]) / 2) * 2;\n\n    aspect = width / height;\n\n    if (data.pad) {\n      return getScalePadFilters(width, height, aspect, data.pad);\n    } else {\n      // No autopad requested, rescale to target size\n      return [{ filter: 'scale', options: { w: width, h: height }}];\n    }\n  } else if (fixedWidth || fixedHeight) {\n    if ('aspect' in data) {\n      // Specified aspect ratio\n      width = fixedWidth ? fixedWidth[1] : Math.round(Number(fixedHeight[1]) * data.aspect);\n      height = fixedHeight ? fixedHeight[1] : Math.round(Number(fixedWidth[1]) / data.aspect);\n\n      // Round to multiples of 2\n      width = Math.round(width / 2) * 2;\n      height = Math.round(height / 2) * 2;\n\n      if (data.pad) {\n        return getScalePadFilters(width, height, data.aspect, data.pad);\n      } else {\n        // No autopad requested, rescale to target size\n        return [{ filter: 'scale', options: { w: width, h: height }}];\n      }\n    } else {\n      // Keep input aspect ratio\n\n      if (fixedWidth) {\n        return [{\n          filter: 'scale',\n          options: {\n            w: Math.round(Number(fixedWidth[1]) / 2) * 2,\n            h: 'trunc(ow/a/2)*2'\n          }\n        }];\n      } else {\n        return [{\n          filter: 'scale',\n          options: {\n            w: 'trunc(oh*a/2)*2',\n            h: Math.round(Number(fixedHeight[1]) / 2) * 2\n          }\n        }];\n      }\n    }\n  } else {\n    throw new Error('Invalid size specified: ' + data.size);\n  }\n}\n\n\n/*\n *! Video size-related methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Keep display aspect ratio\n   *\n   * This method is useful when converting an input with non-square pixels to an output format\n   * that does not support non-square pixels.  It rescales the input so that the display aspect\n   * ratio is the same.\n   *\n   * @method FfmpegCommand#keepDAR\n   * @category Video size\n   * @aliases keepPixelAspect,keepDisplayAspect,keepDisplayAspectRatio\n   *\n   * @return FfmpegCommand\n   */\n  proto.keepPixelAspect = // Only for compatibility, this is not about keeping _pixel_ aspect ratio\n  proto.keepDisplayAspect =\n  proto.keepDisplayAspectRatio =\n  proto.keepDAR = function() {\n    return this.videoFilters([\n      {\n        filter: 'scale',\n        options: {\n          w: 'if(gt(sar,1),iw*sar,iw)',\n          h: 'if(lt(sar,1),ih/sar,ih)'\n        }\n      },\n      {\n        filter: 'setsar',\n        options: '1'\n      }\n    ]);\n  };\n\n\n  /**\n   * Set output size\n   *\n   * The 'size' parameter can have one of 4 forms:\n   * - 'X%': rescale to xx % of the original size\n   * - 'WxH': specify width and height\n   * - 'Wx?': specify width and compute height from input aspect ratio\n   * - '?xH': specify height and compute width from input aspect ratio\n   *\n   * Note: both dimensions will be truncated to multiples of 2.\n   *\n   * @method FfmpegCommand#size\n   * @category Video size\n   * @aliases withSize,setSize\n   *\n   * @param {String} size size string, eg. '33%', '320x240', '320x?', '?x240'\n   * @return FfmpegCommand\n   */\n  proto.withSize =\n  proto.setSize =\n  proto.size = function(size) {\n    var filters = createSizeFilters(this._currentOutput, 'size', size);\n\n    this._currentOutput.sizeFilters.clear();\n    this._currentOutput.sizeFilters(filters);\n\n    return this;\n  };\n\n\n  /**\n   * Set output aspect ratio\n   *\n   * @method FfmpegCommand#aspect\n   * @category Video size\n   * @aliases withAspect,withAspectRatio,setAspect,setAspectRatio,aspectRatio\n   *\n   * @param {String|Number} aspect aspect ratio (number or 'X:Y' string)\n   * @return FfmpegCommand\n   */\n  proto.withAspect =\n  proto.withAspectRatio =\n  proto.setAspect =\n  proto.setAspectRatio =\n  proto.aspect =\n  proto.aspectRatio = function(aspect) {\n    var a = Number(aspect);\n    if (isNaN(a)) {\n      var match = aspect.match(/^(\\d+):(\\d+)$/);\n      if (match) {\n        a = Number(match[1]) / Number(match[2]);\n      } else {\n        throw new Error('Invalid aspect ratio: ' + aspect);\n      }\n    }\n\n    var filters = createSizeFilters(this._currentOutput, 'aspect', a);\n\n    this._currentOutput.sizeFilters.clear();\n    this._currentOutput.sizeFilters(filters);\n\n    return this;\n  };\n\n\n  /**\n   * Enable auto-padding the output\n   *\n   * @method FfmpegCommand#autopad\n   * @category Video size\n   * @aliases applyAutopadding,applyAutoPadding,applyAutopad,applyAutoPad,withAutopadding,withAutoPadding,withAutopad,withAutoPad,autoPad\n   *\n   * @param {Boolean} [pad=true] enable/disable auto-padding\n   * @param {String} [color='black'] pad color\n   */\n  proto.applyAutopadding =\n  proto.applyAutoPadding =\n  proto.applyAutopad =\n  proto.applyAutoPad =\n  proto.withAutopadding =\n  proto.withAutoPadding =\n  proto.withAutopad =\n  proto.withAutoPad =\n  proto.autoPad =\n  proto.autopad = function(pad, color) {\n    // Allow autopad(color)\n    if (typeof pad === 'string') {\n      color = pad;\n      pad = true;\n    }\n\n    // Allow autopad() and autopad(undefined, color)\n    if (typeof pad === 'undefined') {\n      pad = true;\n    }\n\n    var filters = createSizeFilters(this._currentOutput, 'pad', pad ? color || 'black' : false);\n\n    this._currentOutput.sizeFilters.clear();\n    this._currentOutput.sizeFilters(filters);\n\n    return this;\n  };\n};\n","module.exports = require(\"events\");","/**\n * Module dependencies.\n */\n\nvar tty = require('tty');\nvar util = require('util');\n\n/**\n * This is the Node.js implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.init = init;\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\n\n/**\n * Colors.\n */\n\nexports.colors = [6, 2, 3, 4, 5, 1];\n\n/**\n * Build up the default `inspectOpts` object from the environment variables.\n *\n *   $ DEBUG_COLORS=no DEBUG_DEPTH=10 DEBUG_SHOW_HIDDEN=enabled node script.js\n */\n\nexports.inspectOpts = Object.keys(process.env).filter(function (key) {\n  return /^debug_/i.test(key);\n}).reduce(function (obj, key) {\n  // camel-case\n  var prop = key\n    .substring(6)\n    .toLowerCase()\n    .replace(/_([a-z])/g, function (_, k) { return k.toUpperCase() });\n\n  // coerce string value into JS value\n  var val = process.env[key];\n  if (/^(yes|on|true|enabled)$/i.test(val)) val = true;\n  else if (/^(no|off|false|disabled)$/i.test(val)) val = false;\n  else if (val === 'null') val = null;\n  else val = Number(val);\n\n  obj[prop] = val;\n  return obj;\n}, {});\n\n/**\n * The file descriptor to write the `debug()` calls to.\n * Set the `DEBUG_FD` env variable to override with another value. i.e.:\n *\n *   $ DEBUG_FD=3 node script.js 3>debug.log\n */\n\nvar fd = parseInt(process.env.DEBUG_FD, 10) || 2;\n\nif (1 !== fd && 2 !== fd) {\n  util.deprecate(function(){}, 'except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)')()\n}\n\nvar stream = 1 === fd ? process.stdout :\n             2 === fd ? process.stderr :\n             createWritableStdioStream(fd);\n\n/**\n * Is stdout a TTY? Colored output is enabled when `true`.\n */\n\nfunction useColors() {\n  return 'colors' in exports.inspectOpts\n    ? Boolean(exports.inspectOpts.colors)\n    : tty.isatty(fd);\n}\n\n/**\n * Map %o to `util.inspect()`, all on a single line.\n */\n\nexports.formatters.o = function(v) {\n  this.inspectOpts.colors = this.useColors;\n  return util.inspect(v, this.inspectOpts)\n    .split('\\n').map(function(str) {\n      return str.trim()\n    }).join(' ');\n};\n\n/**\n * Map %o to `util.inspect()`, allowing multiple lines if needed.\n */\n\nexports.formatters.O = function(v) {\n  this.inspectOpts.colors = this.useColors;\n  return util.inspect(v, this.inspectOpts);\n};\n\n/**\n * Adds ANSI color escape codes if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var name = this.namespace;\n  var useColors = this.useColors;\n\n  if (useColors) {\n    var c = this.color;\n    var prefix = '  \\u001b[3' + c + ';1m' + name + ' ' + '\\u001b[0m';\n\n    args[0] = prefix + args[0].split('\\n').join('\\n' + prefix);\n    args.push('\\u001b[3' + c + 'm+' + exports.humanize(this.diff) + '\\u001b[0m');\n  } else {\n    args[0] = new Date().toUTCString()\n      + ' ' + name + ' ' + args[0];\n  }\n}\n\n/**\n * Invokes `util.format()` with the specified arguments and writes to `stream`.\n */\n\nfunction log() {\n  return stream.write(util.format.apply(util, arguments) + '\\n');\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  if (null == namespaces) {\n    // If you set a process.env field to null or undefined, it gets cast to the\n    // string 'null' or 'undefined'. Just delete instead.\n    delete process.env.DEBUG;\n  } else {\n    process.env.DEBUG = namespaces;\n  }\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  return process.env.DEBUG;\n}\n\n/**\n * Copied from `node/src/node.js`.\n *\n * XXX: It's lame that node doesn't expose this API out-of-the-box. It also\n * relies on the undocumented `tty_wrap.guessHandleType()` which is also lame.\n */\n\nfunction createWritableStdioStream (fd) {\n  var stream;\n  var tty_wrap = process.binding('tty_wrap');\n\n  // Note stream._type is used for test-module-load-list.js\n\n  switch (tty_wrap.guessHandleType(fd)) {\n    case 'TTY':\n      stream = new tty.WriteStream(fd);\n      stream._type = 'tty';\n\n      // Hack to have stream not keep the event loop alive.\n      // See https://github.com/joyent/node/issues/1726\n      if (stream._handle && stream._handle.unref) {\n        stream._handle.unref();\n      }\n      break;\n\n    case 'FILE':\n      var fs = require('fs');\n      stream = new fs.SyncWriteStream(fd, { autoClose: false });\n      stream._type = 'fs';\n      break;\n\n    case 'PIPE':\n    case 'TCP':\n      var net = require('net');\n      stream = new net.Socket({\n        fd: fd,\n        readable: false,\n        writable: true\n      });\n\n      // FIXME Should probably have an option in net.Socket to create a\n      // stream from an existing fd which is writable only. But for now\n      // we'll just add this hack and set the `readable` member to false.\n      // Test: ./node test/fixtures/echo.js < /etc/passwd\n      stream.readable = false;\n      stream.read = null;\n      stream._type = 'pipe';\n\n      // FIXME Hack to have stream not keep the event loop alive.\n      // See https://github.com/joyent/node/issues/1726\n      if (stream._handle && stream._handle.unref) {\n        stream._handle.unref();\n      }\n      break;\n\n    default:\n      // Probably an error on in uv_guess_handle()\n      throw new Error('Implement me. Unknown stream file type!');\n  }\n\n  // For supporting legacy API we put the FD here.\n  stream.fd = fd;\n\n  stream._isStdio = true;\n\n  return stream;\n}\n\n/**\n * Init logic for `debug` instances.\n *\n * Create a new `inspectOpts` object in case `useColors` is set\n * differently for a particular `debug` instance.\n */\n\nfunction init (debug) {\n  debug.inspectOpts = {};\n\n  var keys = Object.keys(exports.inspectOpts);\n  for (var i = 0; i < keys.length; i++) {\n    debug.inspectOpts[keys[i]] = exports.inspectOpts[keys[i]];\n  }\n}\n\n/**\n * Enable namespaces listed in `process.env.DEBUG` initially.\n */\n\nexports.enable(load());\n","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  'lightseagreen',\n  'forestgreen',\n  'goldenrod',\n  'dodgerblue',\n  'darkorchid',\n  'crimson'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  if (ms >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (ms >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (ms >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (ms >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  return plural(ms, d, 'day') ||\n    plural(ms, h, 'hour') ||\n    plural(ms, m, 'minute') ||\n    plural(ms, s, 'second') ||\n    ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) {\n    return;\n  }\n  if (ms < n * 1.5) {\n    return Math.floor(ms / n) + ' ' + name;\n  }\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Previous log timestamp.\n */\n\nvar prevTime;\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  return debug;\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (var i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","/*global setImmediate: false, setTimeout: false, console: false */\n(function () {\n\n    var async = {};\n\n    // global on the server, window in the browser\n    var root, previous_async;\n\n    root = this;\n    if (root != null) {\n      previous_async = root.async;\n    }\n\n    async.noConflict = function () {\n        root.async = previous_async;\n        return async;\n    };\n\n    function only_once(fn) {\n        var called = false;\n        return function() {\n            if (called) throw new Error(\"Callback was already called.\");\n            called = true;\n            fn.apply(root, arguments);\n        }\n    }\n\n    //// cross-browser compatiblity functions ////\n\n    var _each = function (arr, iterator) {\n        if (arr.forEach) {\n            return arr.forEach(iterator);\n        }\n        for (var i = 0; i < arr.length; i += 1) {\n            iterator(arr[i], i, arr);\n        }\n    };\n\n    var _map = function (arr, iterator) {\n        if (arr.map) {\n            return arr.map(iterator);\n        }\n        var results = [];\n        _each(arr, function (x, i, a) {\n            results.push(iterator(x, i, a));\n        });\n        return results;\n    };\n\n    var _reduce = function (arr, iterator, memo) {\n        if (arr.reduce) {\n            return arr.reduce(iterator, memo);\n        }\n        _each(arr, function (x, i, a) {\n            memo = iterator(memo, x, i, a);\n        });\n        return memo;\n    };\n\n    var _keys = function (obj) {\n        if (Object.keys) {\n            return Object.keys(obj);\n        }\n        var keys = [];\n        for (var k in obj) {\n            if (obj.hasOwnProperty(k)) {\n                keys.push(k);\n            }\n        }\n        return keys;\n    };\n\n    //// exported async module functions ////\n\n    //// nextTick implementation with browser-compatible fallback ////\n    if (typeof process === 'undefined' || !(process.nextTick)) {\n        if (typeof setImmediate === 'function') {\n            async.nextTick = function (fn) {\n                // not a direct alias for IE10 compatibility\n                setImmediate(fn);\n            };\n            async.setImmediate = async.nextTick;\n        }\n        else {\n            async.nextTick = function (fn) {\n                setTimeout(fn, 0);\n            };\n            async.setImmediate = async.nextTick;\n        }\n    }\n    else {\n        async.nextTick = process.nextTick;\n        if (typeof setImmediate !== 'undefined') {\n            async.setImmediate = function (fn) {\n              // not a direct alias for IE10 compatibility\n              setImmediate(fn);\n            };\n        }\n        else {\n            async.setImmediate = async.nextTick;\n        }\n    }\n\n    async.each = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        _each(arr, function (x) {\n            iterator(x, only_once(function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed >= arr.length) {\n                        callback(null);\n                    }\n                }\n            }));\n        });\n    };\n    async.forEach = async.each;\n\n    async.eachSeries = function (arr, iterator, callback) {\n        callback = callback || function () {};\n        if (!arr.length) {\n            return callback();\n        }\n        var completed = 0;\n        var iterate = function () {\n            iterator(arr[completed], function (err) {\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                }\n                else {\n                    completed += 1;\n                    if (completed >= arr.length) {\n                        callback(null);\n                    }\n                    else {\n                        iterate();\n                    }\n                }\n            });\n        };\n        iterate();\n    };\n    async.forEachSeries = async.eachSeries;\n\n    async.eachLimit = function (arr, limit, iterator, callback) {\n        var fn = _eachLimit(limit);\n        fn.apply(null, [arr, iterator, callback]);\n    };\n    async.forEachLimit = async.eachLimit;\n\n    var _eachLimit = function (limit) {\n\n        return function (arr, iterator, callback) {\n            callback = callback || function () {};\n            if (!arr.length || limit <= 0) {\n                return callback();\n            }\n            var completed = 0;\n            var started = 0;\n            var running = 0;\n\n            (function replenish () {\n                if (completed >= arr.length) {\n                    return callback();\n                }\n\n                while (running < limit && started < arr.length) {\n                    started += 1;\n                    running += 1;\n                    iterator(arr[started - 1], function (err) {\n                        if (err) {\n                            callback(err);\n                            callback = function () {};\n                        }\n                        else {\n                            completed += 1;\n                            running -= 1;\n                            if (completed >= arr.length) {\n                                callback();\n                            }\n                            else {\n                                replenish();\n                            }\n                        }\n                    });\n                }\n            })();\n        };\n    };\n\n\n    var doParallel = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.each].concat(args));\n        };\n    };\n    var doParallelLimit = function(limit, fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [_eachLimit(limit)].concat(args));\n        };\n    };\n    var doSeries = function (fn) {\n        return function () {\n            var args = Array.prototype.slice.call(arguments);\n            return fn.apply(null, [async.eachSeries].concat(args));\n        };\n    };\n\n\n    var _asyncMap = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (err, v) {\n                results[x.index] = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, results);\n        });\n    };\n    async.map = doParallel(_asyncMap);\n    async.mapSeries = doSeries(_asyncMap);\n    async.mapLimit = function (arr, limit, iterator, callback) {\n        return _mapLimit(limit)(arr, iterator, callback);\n    };\n\n    var _mapLimit = function(limit) {\n        return doParallelLimit(limit, _asyncMap);\n    };\n\n    // reduce only has a series version, as doing reduce in parallel won't\n    // work in many situations.\n    async.reduce = function (arr, memo, iterator, callback) {\n        async.eachSeries(arr, function (x, callback) {\n            iterator(memo, x, function (err, v) {\n                memo = v;\n                callback(err);\n            });\n        }, function (err) {\n            callback(err, memo);\n        });\n    };\n    // inject alias\n    async.inject = async.reduce;\n    // foldl alias\n    async.foldl = async.reduce;\n\n    async.reduceRight = function (arr, memo, iterator, callback) {\n        var reversed = _map(arr, function (x) {\n            return x;\n        }).reverse();\n        async.reduce(reversed, memo, iterator, callback);\n    };\n    // foldr alias\n    async.foldr = async.reduceRight;\n\n    var _filter = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.filter = doParallel(_filter);\n    async.filterSeries = doSeries(_filter);\n    // select alias\n    async.select = async.filter;\n    async.selectSeries = async.filterSeries;\n\n    var _reject = function (eachfn, arr, iterator, callback) {\n        var results = [];\n        arr = _map(arr, function (x, i) {\n            return {index: i, value: x};\n        });\n        eachfn(arr, function (x, callback) {\n            iterator(x.value, function (v) {\n                if (!v) {\n                    results.push(x);\n                }\n                callback();\n            });\n        }, function (err) {\n            callback(_map(results.sort(function (a, b) {\n                return a.index - b.index;\n            }), function (x) {\n                return x.value;\n            }));\n        });\n    };\n    async.reject = doParallel(_reject);\n    async.rejectSeries = doSeries(_reject);\n\n    var _detect = function (eachfn, arr, iterator, main_callback) {\n        eachfn(arr, function (x, callback) {\n            iterator(x, function (result) {\n                if (result) {\n                    main_callback(x);\n                    main_callback = function () {};\n                }\n                else {\n                    callback();\n                }\n            });\n        }, function (err) {\n            main_callback();\n        });\n    };\n    async.detect = doParallel(_detect);\n    async.detectSeries = doSeries(_detect);\n\n    async.some = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (v) {\n                    main_callback(true);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(false);\n        });\n    };\n    // any alias\n    async.any = async.some;\n\n    async.every = function (arr, iterator, main_callback) {\n        async.each(arr, function (x, callback) {\n            iterator(x, function (v) {\n                if (!v) {\n                    main_callback(false);\n                    main_callback = function () {};\n                }\n                callback();\n            });\n        }, function (err) {\n            main_callback(true);\n        });\n    };\n    // all alias\n    async.all = async.every;\n\n    async.sortBy = function (arr, iterator, callback) {\n        async.map(arr, function (x, callback) {\n            iterator(x, function (err, criteria) {\n                if (err) {\n                    callback(err);\n                }\n                else {\n                    callback(null, {value: x, criteria: criteria});\n                }\n            });\n        }, function (err, results) {\n            if (err) {\n                return callback(err);\n            }\n            else {\n                var fn = function (left, right) {\n                    var a = left.criteria, b = right.criteria;\n                    return a < b ? -1 : a > b ? 1 : 0;\n                };\n                callback(null, _map(results.sort(fn), function (x) {\n                    return x.value;\n                }));\n            }\n        });\n    };\n\n    async.auto = function (tasks, callback) {\n        callback = callback || function () {};\n        var keys = _keys(tasks);\n        if (!keys.length) {\n            return callback(null);\n        }\n\n        var results = {};\n\n        var listeners = [];\n        var addListener = function (fn) {\n            listeners.unshift(fn);\n        };\n        var removeListener = function (fn) {\n            for (var i = 0; i < listeners.length; i += 1) {\n                if (listeners[i] === fn) {\n                    listeners.splice(i, 1);\n                    return;\n                }\n            }\n        };\n        var taskComplete = function () {\n            _each(listeners.slice(0), function (fn) {\n                fn();\n            });\n        };\n\n        addListener(function () {\n            if (_keys(results).length === keys.length) {\n                callback(null, results);\n                callback = function () {};\n            }\n        });\n\n        _each(keys, function (k) {\n            var task = (tasks[k] instanceof Function) ? [tasks[k]]: tasks[k];\n            var taskCallback = function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (args.length <= 1) {\n                    args = args[0];\n                }\n                if (err) {\n                    var safeResults = {};\n                    _each(_keys(results), function(rkey) {\n                        safeResults[rkey] = results[rkey];\n                    });\n                    safeResults[k] = args;\n                    callback(err, safeResults);\n                    // stop subsequent errors hitting callback multiple times\n                    callback = function () {};\n                }\n                else {\n                    results[k] = args;\n                    async.setImmediate(taskComplete);\n                }\n            };\n            var requires = task.slice(0, Math.abs(task.length - 1)) || [];\n            var ready = function () {\n                return _reduce(requires, function (a, x) {\n                    return (a && results.hasOwnProperty(x));\n                }, true) && !results.hasOwnProperty(k);\n            };\n            if (ready()) {\n                task[task.length - 1](taskCallback, results);\n            }\n            else {\n                var listener = function () {\n                    if (ready()) {\n                        removeListener(listener);\n                        task[task.length - 1](taskCallback, results);\n                    }\n                };\n                addListener(listener);\n            }\n        });\n    };\n\n    async.waterfall = function (tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor !== Array) {\n          var err = new Error('First argument to waterfall must be an array of functions');\n          return callback(err);\n        }\n        if (!tasks.length) {\n            return callback();\n        }\n        var wrapIterator = function (iterator) {\n            return function (err) {\n                if (err) {\n                    callback.apply(null, arguments);\n                    callback = function () {};\n                }\n                else {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    var next = iterator.next();\n                    if (next) {\n                        args.push(wrapIterator(next));\n                    }\n                    else {\n                        args.push(callback);\n                    }\n                    async.setImmediate(function () {\n                        iterator.apply(null, args);\n                    });\n                }\n            };\n        };\n        wrapIterator(async.iterator(tasks))();\n    };\n\n    var _parallel = function(eachfn, tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor === Array) {\n            eachfn.map(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            eachfn.each(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.parallel = function (tasks, callback) {\n        _parallel({ map: async.map, each: async.each }, tasks, callback);\n    };\n\n    async.parallelLimit = function(tasks, limit, callback) {\n        _parallel({ map: _mapLimit(limit), each: _eachLimit(limit) }, tasks, callback);\n    };\n\n    async.series = function (tasks, callback) {\n        callback = callback || function () {};\n        if (tasks.constructor === Array) {\n            async.mapSeries(tasks, function (fn, callback) {\n                if (fn) {\n                    fn(function (err) {\n                        var args = Array.prototype.slice.call(arguments, 1);\n                        if (args.length <= 1) {\n                            args = args[0];\n                        }\n                        callback.call(null, err, args);\n                    });\n                }\n            }, callback);\n        }\n        else {\n            var results = {};\n            async.eachSeries(_keys(tasks), function (k, callback) {\n                tasks[k](function (err) {\n                    var args = Array.prototype.slice.call(arguments, 1);\n                    if (args.length <= 1) {\n                        args = args[0];\n                    }\n                    results[k] = args;\n                    callback(err);\n                });\n            }, function (err) {\n                callback(err, results);\n            });\n        }\n    };\n\n    async.iterator = function (tasks) {\n        var makeCallback = function (index) {\n            var fn = function () {\n                if (tasks.length) {\n                    tasks[index].apply(null, arguments);\n                }\n                return fn.next();\n            };\n            fn.next = function () {\n                return (index < tasks.length - 1) ? makeCallback(index + 1): null;\n            };\n            return fn;\n        };\n        return makeCallback(0);\n    };\n\n    async.apply = function (fn) {\n        var args = Array.prototype.slice.call(arguments, 1);\n        return function () {\n            return fn.apply(\n                null, args.concat(Array.prototype.slice.call(arguments))\n            );\n        };\n    };\n\n    var _concat = function (eachfn, arr, fn, callback) {\n        var r = [];\n        eachfn(arr, function (x, cb) {\n            fn(x, function (err, y) {\n                r = r.concat(y || []);\n                cb(err);\n            });\n        }, function (err) {\n            callback(err, r);\n        });\n    };\n    async.concat = doParallel(_concat);\n    async.concatSeries = doSeries(_concat);\n\n    async.whilst = function (test, iterator, callback) {\n        if (test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.whilst(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doWhilst = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            if (test()) {\n                async.doWhilst(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.until = function (test, iterator, callback) {\n        if (!test()) {\n            iterator(function (err) {\n                if (err) {\n                    return callback(err);\n                }\n                async.until(test, iterator, callback);\n            });\n        }\n        else {\n            callback();\n        }\n    };\n\n    async.doUntil = function (iterator, test, callback) {\n        iterator(function (err) {\n            if (err) {\n                return callback(err);\n            }\n            if (!test()) {\n                async.doUntil(iterator, test, callback);\n            }\n            else {\n                callback();\n            }\n        });\n    };\n\n    async.queue = function (worker, concurrency) {\n        if (concurrency === undefined) {\n            concurrency = 1;\n        }\n        function _insert(q, data, pos, callback) {\n          if(data.constructor !== Array) {\n              data = [data];\n          }\n          _each(data, function(task) {\n              var item = {\n                  data: task,\n                  callback: typeof callback === 'function' ? callback : null\n              };\n\n              if (pos) {\n                q.tasks.unshift(item);\n              } else {\n                q.tasks.push(item);\n              }\n\n              if (q.saturated && q.tasks.length === concurrency) {\n                  q.saturated();\n              }\n              async.setImmediate(q.process);\n          });\n        }\n\n        var workers = 0;\n        var q = {\n            tasks: [],\n            concurrency: concurrency,\n            saturated: null,\n            empty: null,\n            drain: null,\n            push: function (data, callback) {\n              _insert(q, data, false, callback);\n            },\n            unshift: function (data, callback) {\n              _insert(q, data, true, callback);\n            },\n            process: function () {\n                if (workers < q.concurrency && q.tasks.length) {\n                    var task = q.tasks.shift();\n                    if (q.empty && q.tasks.length === 0) {\n                        q.empty();\n                    }\n                    workers += 1;\n                    var next = function () {\n                        workers -= 1;\n                        if (task.callback) {\n                            task.callback.apply(task, arguments);\n                        }\n                        if (q.drain && q.tasks.length + workers === 0) {\n                            q.drain();\n                        }\n                        q.process();\n                    };\n                    var cb = only_once(next);\n                    worker(task.data, cb);\n                }\n            },\n            length: function () {\n                return q.tasks.length;\n            },\n            running: function () {\n                return workers;\n            }\n        };\n        return q;\n    };\n\n    async.cargo = function (worker, payload) {\n        var working     = false,\n            tasks       = [];\n\n        var cargo = {\n            tasks: tasks,\n            payload: payload,\n            saturated: null,\n            empty: null,\n            drain: null,\n            push: function (data, callback) {\n                if(data.constructor !== Array) {\n                    data = [data];\n                }\n                _each(data, function(task) {\n                    tasks.push({\n                        data: task,\n                        callback: typeof callback === 'function' ? callback : null\n                    });\n                    if (cargo.saturated && tasks.length === payload) {\n                        cargo.saturated();\n                    }\n                });\n                async.setImmediate(cargo.process);\n            },\n            process: function process() {\n                if (working) return;\n                if (tasks.length === 0) {\n                    if(cargo.drain) cargo.drain();\n                    return;\n                }\n\n                var ts = typeof payload === 'number'\n                            ? tasks.splice(0, payload)\n                            : tasks.splice(0);\n\n                var ds = _map(ts, function (task) {\n                    return task.data;\n                });\n\n                if(cargo.empty) cargo.empty();\n                working = true;\n                worker(ds, function () {\n                    working = false;\n\n                    var args = arguments;\n                    _each(ts, function (data) {\n                        if (data.callback) {\n                            data.callback.apply(null, args);\n                        }\n                    });\n\n                    process();\n                });\n            },\n            length: function () {\n                return tasks.length;\n            },\n            running: function () {\n                return working;\n            }\n        };\n        return cargo;\n    };\n\n    var _console_fn = function (name) {\n        return function (fn) {\n            var args = Array.prototype.slice.call(arguments, 1);\n            fn.apply(null, args.concat([function (err) {\n                var args = Array.prototype.slice.call(arguments, 1);\n                if (typeof console !== 'undefined') {\n                    if (err) {\n                        if (console.error) {\n                            console.error(err);\n                        }\n                    }\n                    else if (console[name]) {\n                        _each(args, function (x) {\n                            console[name](x);\n                        });\n                    }\n                }\n            }]));\n        };\n    };\n    async.log = _console_fn('log');\n    async.dir = _console_fn('dir');\n    /*async.info = _console_fn('info');\n    async.warn = _console_fn('warn');\n    async.error = _console_fn('error');*/\n\n    async.memoize = function (fn, hasher) {\n        var memo = {};\n        var queues = {};\n        hasher = hasher || function (x) {\n            return x;\n        };\n        var memoized = function () {\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            var key = hasher.apply(null, args);\n            if (key in memo) {\n                callback.apply(null, memo[key]);\n            }\n            else if (key in queues) {\n                queues[key].push(callback);\n            }\n            else {\n                queues[key] = [callback];\n                fn.apply(null, args.concat([function () {\n                    memo[key] = arguments;\n                    var q = queues[key];\n                    delete queues[key];\n                    for (var i = 0, l = q.length; i < l; i++) {\n                      q[i].apply(null, arguments);\n                    }\n                }]));\n            }\n        };\n        memoized.memo = memo;\n        memoized.unmemoized = fn;\n        return memoized;\n    };\n\n    async.unmemoize = function (fn) {\n      return function () {\n        return (fn.unmemoized || fn).apply(null, arguments);\n      };\n    };\n\n    async.times = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.map(counter, iterator, callback);\n    };\n\n    async.timesSeries = function (count, iterator, callback) {\n        var counter = [];\n        for (var i = 0; i < count; i++) {\n            counter.push(i);\n        }\n        return async.mapSeries(counter, iterator, callback);\n    };\n\n    async.compose = function (/* functions... */) {\n        var fns = Array.prototype.reverse.call(arguments);\n        return function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            async.reduce(fns, args, function (newargs, fn, cb) {\n                fn.apply(that, newargs.concat([function () {\n                    var err = arguments[0];\n                    var nextargs = Array.prototype.slice.call(arguments, 1);\n                    cb(err, nextargs);\n                }]))\n            },\n            function (err, results) {\n                callback.apply(that, [err].concat(results));\n            });\n        };\n    };\n\n    var _applyEach = function (eachfn, fns /*args...*/) {\n        var go = function () {\n            var that = this;\n            var args = Array.prototype.slice.call(arguments);\n            var callback = args.pop();\n            return eachfn(fns, function (fn, cb) {\n                fn.apply(that, args.concat([cb]));\n            },\n            callback);\n        };\n        if (arguments.length > 2) {\n            var args = Array.prototype.slice.call(arguments, 2);\n            return go.apply(this, args);\n        }\n        else {\n            return go;\n        }\n    };\n    async.applyEach = doParallel(_applyEach);\n    async.applyEachSeries = doSeries(_applyEach);\n\n    async.forever = function (fn, callback) {\n        function next(err) {\n            if (err) {\n                if (callback) {\n                    return callback(err);\n                }\n                throw err;\n            }\n            fn(next);\n        }\n        next();\n    };\n\n    // AMD / RequireJS\n    if (typeof define !== 'undefined' && define.amd) {\n        define([], function () {\n            return async;\n        });\n    }\n    // Node.js\n    else if (typeof module !== 'undefined' && module.exports) {\n        module.exports = async;\n    }\n    // included directly via <script> tag\n    else {\n        root.async = async;\n    }\n\n}());\n","module.exports = isexe\nisexe.sync = sync\n\nvar fs = require('fs')\n\nfunction isexe (path, options, cb) {\n  fs.stat(path, function (er, stat) {\n    cb(er, er ? false : checkStat(stat, options))\n  })\n}\n\nfunction sync (path, options) {\n  return checkStat(fs.statSync(path), options)\n}\n\nfunction checkStat (stat, options) {\n  return stat.isFile() && checkMode(stat, options)\n}\n\nfunction checkMode (stat, options) {\n  var mod = stat.mode\n  var uid = stat.uid\n  var gid = stat.gid\n\n  var myUid = options.uid !== undefined ?\n    options.uid : process.getuid && process.getuid()\n  var myGid = options.gid !== undefined ?\n    options.gid : process.getgid && process.getgid()\n\n  var u = parseInt('100', 8)\n  var g = parseInt('010', 8)\n  var o = parseInt('001', 8)\n  var ug = u | g\n\n  var ret = (mod & o) ||\n    (mod & g) && gid === myGid ||\n    (mod & u) && uid === myUid ||\n    (mod & ug) && myUid === 0\n\n  return ret\n}\n","/*jshint node:true*/\n'use strict';\n\nvar utils = require('../utils');\n\n\n/*\n *! Video-related methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Disable video in the output\n   *\n   * @method FfmpegCommand#noVideo\n   * @category Video\n   * @aliases withNoVideo\n   *\n   * @return FfmpegCommand\n   */\n  proto.withNoVideo =\n  proto.noVideo = function() {\n    this._currentOutput.video.clear();\n    this._currentOutput.videoFilters.clear();\n    this._currentOutput.video('-vn');\n\n    return this;\n  };\n\n\n  /**\n   * Specify video codec\n   *\n   * @method FfmpegCommand#videoCodec\n   * @category Video\n   * @aliases withVideoCodec\n   *\n   * @param {String} codec video codec name\n   * @return FfmpegCommand\n   */\n  proto.withVideoCodec =\n  proto.videoCodec = function(codec) {\n    this._currentOutput.video('-vcodec', codec);\n    return this;\n  };\n\n\n  /**\n   * Specify video bitrate\n   *\n   * @method FfmpegCommand#videoBitrate\n   * @category Video\n   * @aliases withVideoBitrate\n   *\n   * @param {String|Number} bitrate video bitrate in kbps (with an optional 'k' suffix)\n   * @param {Boolean} [constant=false] enforce constant bitrate\n   * @return FfmpegCommand\n   */\n  proto.withVideoBitrate =\n  proto.videoBitrate = function(bitrate, constant) {\n    bitrate = ('' + bitrate).replace(/k?$/, 'k');\n\n    this._currentOutput.video('-b:v', bitrate);\n    if (constant) {\n      this._currentOutput.video(\n        '-maxrate', bitrate,\n        '-minrate', bitrate,\n        '-bufsize', '3M'\n      );\n    }\n\n    return this;\n  };\n\n\n  /**\n   * Specify custom video filter(s)\n   *\n   * Can be called both with one or many filters, or a filter array.\n   *\n   * @example\n   * command.videoFilters('filter1');\n   *\n   * @example\n   * command.videoFilters('filter1', 'filter2=param1=value1:param2=value2');\n   *\n   * @example\n   * command.videoFilters(['filter1', 'filter2']);\n   *\n   * @example\n   * command.videoFilters([\n   *   {\n   *     filter: 'filter1'\n   *   },\n   *   {\n   *     filter: 'filter2',\n   *     options: 'param=value:param=value'\n   *   }\n   * ]);\n   *\n   * @example\n   * command.videoFilters(\n   *   {\n   *     filter: 'filter1',\n   *     options: ['value1', 'value2']\n   *   },\n   *   {\n   *     filter: 'filter2',\n   *     options: { param1: 'value1', param2: 'value2' }\n   *   }\n   * );\n   *\n   * @method FfmpegCommand#videoFilters\n   * @category Video\n   * @aliases withVideoFilter,withVideoFilters,videoFilter\n   *\n   * @param {...String|String[]|Object[]} filters video filter strings, string array or\n   *   filter specification array, each with the following properties:\n   * @param {String} filters.filter filter name\n   * @param {String|String[]|Object} [filters.options] filter option string, array, or object\n   * @return FfmpegCommand\n   */\n  proto.withVideoFilter =\n  proto.withVideoFilters =\n  proto.videoFilter =\n  proto.videoFilters = function(filters) {\n    if (arguments.length > 1) {\n      filters = [].slice.call(arguments);\n    }\n\n    if (!Array.isArray(filters)) {\n      filters = [filters];\n    }\n\n    this._currentOutput.videoFilters(utils.makeFilterStrings(filters));\n\n    return this;\n  };\n\n\n  /**\n   * Specify output FPS\n   *\n   * @method FfmpegCommand#fps\n   * @category Video\n   * @aliases withOutputFps,withOutputFPS,withFpsOutput,withFPSOutput,withFps,withFPS,outputFPS,outputFps,fpsOutput,FPSOutput,FPS\n   *\n   * @param {Number} fps output FPS\n   * @return FfmpegCommand\n   */\n  proto.withOutputFps =\n  proto.withOutputFPS =\n  proto.withFpsOutput =\n  proto.withFPSOutput =\n  proto.withFps =\n  proto.withFPS =\n  proto.outputFPS =\n  proto.outputFps =\n  proto.fpsOutput =\n  proto.FPSOutput =\n  proto.fps =\n  proto.FPS = function(fps) {\n    this._currentOutput.video('-r', fps);\n    return this;\n  };\n\n\n  /**\n   * Only transcode a certain number of frames\n   *\n   * @method FfmpegCommand#frames\n   * @category Video\n   * @aliases takeFrames,withFrames\n   *\n   * @param {Number} frames frame count\n   * @return FfmpegCommand\n   */\n  proto.takeFrames =\n  proto.withFrames =\n  proto.frames = function(frames) {\n    this._currentOutput.video('-vframes', frames);\n    return this;\n  };\n};\n","module.exports = which\nwhich.sync = whichSync\n\nvar isWindows = process.platform === 'win32' ||\n    process.env.OSTYPE === 'cygwin' ||\n    process.env.OSTYPE === 'msys'\n\nvar path = require('path')\nvar COLON = isWindows ? ';' : ':'\nvar isexe = require('isexe')\n\nfunction getNotFoundError (cmd) {\n  var er = new Error('not found: ' + cmd)\n  er.code = 'ENOENT'\n\n  return er\n}\n\nfunction getPathInfo (cmd, opt) {\n  var colon = opt.colon || COLON\n  var pathEnv = opt.path || process.env.PATH || ''\n  var pathExt = ['']\n\n  pathEnv = pathEnv.split(colon)\n\n  var pathExtExe = ''\n  if (isWindows) {\n    pathEnv.unshift(process.cwd())\n    pathExtExe = (opt.pathExt || process.env.PATHEXT || '.EXE;.CMD;.BAT;.COM')\n    pathExt = pathExtExe.split(colon)\n\n\n    // Always test the cmd itself first.  isexe will check to make sure\n    // it's found in the pathExt set.\n    if (cmd.indexOf('.') !== -1 && pathExt[0] !== '')\n      pathExt.unshift('')\n  }\n\n  // If it has a slash, then we don't bother searching the pathenv.\n  // just check the file itself, and that's it.\n  if (cmd.match(/\\//) || isWindows && cmd.match(/\\\\/))\n    pathEnv = ['']\n\n  return {\n    env: pathEnv,\n    ext: pathExt,\n    extExe: pathExtExe\n  }\n}\n\nfunction which (cmd, opt, cb) {\n  if (typeof opt === 'function') {\n    cb = opt\n    opt = {}\n  }\n\n  var info = getPathInfo(cmd, opt)\n  var pathEnv = info.env\n  var pathExt = info.ext\n  var pathExtExe = info.extExe\n  var found = []\n\n  ;(function F (i, l) {\n    if (i === l) {\n      if (opt.all && found.length)\n        return cb(null, found)\n      else\n        return cb(getNotFoundError(cmd))\n    }\n\n    var pathPart = pathEnv[i]\n    if (pathPart.charAt(0) === '\"' && pathPart.slice(-1) === '\"')\n      pathPart = pathPart.slice(1, -1)\n\n    var p = path.join(pathPart, cmd)\n    if (!pathPart && (/^\\.[\\\\\\/]/).test(cmd)) {\n      p = cmd.slice(0, 2) + p\n    }\n    ;(function E (ii, ll) {\n      if (ii === ll) return F(i + 1, l)\n      var ext = pathExt[ii]\n      isexe(p + ext, { pathExt: pathExtExe }, function (er, is) {\n        if (!er && is) {\n          if (opt.all)\n            found.push(p + ext)\n          else\n            return cb(null, p + ext)\n        }\n        return E(ii + 1, ll)\n      })\n    })(0, pathExt.length)\n  })(0, pathEnv.length)\n}\n\nfunction whichSync (cmd, opt) {\n  opt = opt || {}\n\n  var info = getPathInfo(cmd, opt)\n  var pathEnv = info.env\n  var pathExt = info.ext\n  var pathExtExe = info.extExe\n  var found = []\n\n  for (var i = 0, l = pathEnv.length; i < l; i ++) {\n    var pathPart = pathEnv[i]\n    if (pathPart.charAt(0) === '\"' && pathPart.slice(-1) === '\"')\n      pathPart = pathPart.slice(1, -1)\n\n    var p = path.join(pathPart, cmd)\n    if (!pathPart && /^\\.[\\\\\\/]/.test(cmd)) {\n      p = cmd.slice(0, 2) + p\n    }\n    for (var j = 0, ll = pathExt.length; j < ll; j ++) {\n      var cur = p + pathExt[j]\n      var is\n      try {\n        is = isexe.sync(cur, { pathExt: pathExtExe })\n        if (is) {\n          if (opt.all)\n            found.push(cur)\n          else\n            return cur\n        }\n      } catch (ex) {}\n    }\n  }\n\n  if (opt.all && found.length)\n    return found\n\n  if (opt.nothrow)\n    return null\n\n  throw getNotFoundError(cmd)\n}\n","/*jshint node:true, laxcomma:true*/\n'use strict';\n\nvar spawn = require('child_process').spawn;\n\n\nfunction legacyTag(key) { return key.match(/^TAG:/); }\nfunction legacyDisposition(key) { return key.match(/^DISPOSITION:/); }\n\nfunction parseFfprobeOutput(out) {\n  var lines = out.split(/\\r\\n|\\r|\\n/);\n\n  lines = lines.filter(function (line) {\n    return line.length > 0;\n  });\n\n  var data = {\n    streams: [],\n    format: {},\n    chapters: []\n  };\n\n  function parseBlock(name) {\n    var data = {};\n\n    var line = lines.shift();\n    while (typeof line !== 'undefined') {\n      if (line.toLowerCase() == '[/'+name+']') {\n        return data;\n      } else if (line.match(/^\\[/)) {\n        line = lines.shift();\n        continue;\n      }\n\n      var kv = line.match(/^([^=]+)=(.*)$/);\n      if (kv) {\n        if (!(kv[1].match(/^TAG:/)) && kv[2].match(/^[0-9]+(\\.[0-9]+)?$/)) {\n          data[kv[1]] = Number(kv[2]);\n        } else {\n          data[kv[1]] = kv[2];\n        }\n      }\n\n      line = lines.shift();\n    }\n\n    return data;\n  }\n\n  var line = lines.shift();\n  while (typeof line !== 'undefined') {\n    if (line.match(/^\\[stream/i)) {\n      var stream = parseBlock('stream');\n      data.streams.push(stream);\n    } else if (line.match(/^\\[chapter/i)) {\n      var chapter = parseBlock('chapter');\n      data.chapters.push(chapter);\n    } else if (line.toLowerCase() === '[format]') {\n      data.format = parseBlock('format');\n    }\n\n    line = lines.shift();\n  }\n\n  return data;\n}\n\n\n\nmodule.exports = function(proto) {\n  /**\n   * A callback passed to the {@link FfmpegCommand#ffprobe} method.\n   *\n   * @callback FfmpegCommand~ffprobeCallback\n   *\n   * @param {Error|null} err error object or null if no error happened\n   * @param {Object} ffprobeData ffprobe output data; this object\n   *   has the same format as what the following command returns:\n   *\n   *     `ffprobe -print_format json -show_streams -show_format INPUTFILE`\n   * @param {Array} ffprobeData.streams stream information\n   * @param {Object} ffprobeData.format format information\n   */\n\n  /**\n   * Run ffprobe on last specified input\n   *\n   * @method FfmpegCommand#ffprobe\n   * @category Metadata\n   *\n   * @param {?Number} [index] 0-based index of input to probe (defaults to last input)\n   * @param {?String[]} [options] array of output options to return\n   * @param {FfmpegCommand~ffprobeCallback} callback callback function\n   *\n   */\n  proto.ffprobe = function() {\n    var input, index = null, options = [], callback;\n\n    // the last argument should be the callback\n    var callback = arguments[arguments.length - 1];\n\n    var ended = false\n    function handleCallback(err, data) {\n      if (!ended) {\n        ended = true;\n        callback(err, data);\n      }\n    };\n\n    // map the arguments to the correct variable names\n    switch (arguments.length) {\n      case 3:\n        index = arguments[0];\n        options = arguments[1];\n        break;\n      case 2:\n        if (typeof arguments[0] === 'number') {\n          index = arguments[0];\n        } else if (Array.isArray(arguments[0])) {\n          options = arguments[0];\n        }\n        break;\n    }\n\n\n    if (index === null) {\n      if (!this._currentInput) {\n        return handleCallback(new Error('No input specified'));\n      }\n\n      input = this._currentInput;\n    } else {\n      input = this._inputs[index];\n\n      if (!input) {\n        return handleCallback(new Error('Invalid input index'));\n      }\n    }\n\n    // Find ffprobe\n    this._getFfprobePath(function(err, path) {\n      if (err) {\n        return handleCallback(err);\n      } else if (!path) {\n        return handleCallback(new Error('Cannot find ffprobe'));\n      }\n\n      var stdout = '';\n      var stdoutClosed = false;\n      var stderr = '';\n      var stderrClosed = false;\n\n      // Spawn ffprobe\n      var src = input.isStream ? 'pipe:0' : input.source;\n      var ffprobe = spawn(path, ['-show_streams', '-show_format'].concat(options, src), {windowsHide: true});\n\n      if (input.isStream) {\n        // Skip errors on stdin. These get thrown when ffprobe is complete and\n        // there seems to be no way hook in and close stdin before it throws.\n        ffprobe.stdin.on('error', function(err) {\n          if (['ECONNRESET', 'EPIPE', 'EOF'].indexOf(err.code) >= 0) { return; }\n          handleCallback(err);\n        });\n\n        // Once ffprobe's input stream closes, we need no more data from the\n        // input\n        ffprobe.stdin.on('close', function() {\n            input.source.pause();\n            input.source.unpipe(ffprobe.stdin);\n        });\n\n        input.source.pipe(ffprobe.stdin);\n      }\n\n      ffprobe.on('error', callback);\n\n      // Ensure we wait for captured streams to end before calling callback\n      var exitError = null;\n      function handleExit(err) {\n        if (err) {\n          exitError = err;\n        }\n\n        if (processExited && stdoutClosed && stderrClosed) {\n          if (exitError) {\n            if (stderr) {\n              exitError.message += '\\n' + stderr;\n            }\n\n            return handleCallback(exitError);\n          }\n\n          // Process output\n          var data = parseFfprobeOutput(stdout);\n\n          // Handle legacy output with \"TAG:x\" and \"DISPOSITION:x\" keys\n          [data.format].concat(data.streams).forEach(function(target) {\n            if (target) {\n              var legacyTagKeys = Object.keys(target).filter(legacyTag);\n\n              if (legacyTagKeys.length) {\n                target.tags = target.tags || {};\n\n                legacyTagKeys.forEach(function(tagKey) {\n                  target.tags[tagKey.substr(4)] = target[tagKey];\n                  delete target[tagKey];\n                });\n              }\n\n              var legacyDispositionKeys = Object.keys(target).filter(legacyDisposition);\n\n              if (legacyDispositionKeys.length) {\n                target.disposition = target.disposition || {};\n\n                legacyDispositionKeys.forEach(function(dispositionKey) {\n                  target.disposition[dispositionKey.substr(12)] = target[dispositionKey];\n                  delete target[dispositionKey];\n                });\n              }\n            }\n          });\n\n          handleCallback(null, data);\n        }\n      }\n\n      // Handle ffprobe exit\n      var processExited = false;\n      ffprobe.on('exit', function(code, signal) {\n        processExited = true;\n\n        if (code) {\n          handleExit(new Error('ffprobe exited with code ' + code));\n        } else if (signal) {\n          handleExit(new Error('ffprobe was killed with signal ' + signal));\n        } else {\n          handleExit();\n        }\n      });\n\n      // Handle stdout/stderr streams\n      ffprobe.stdout.on('data', function(data) {\n        stdout += data;\n      });\n\n      ffprobe.stdout.on('close', function() {\n        stdoutClosed = true;\n        handleExit();\n      });\n\n      ffprobe.stderr.on('data', function(data) {\n        stderr += data;\n      });\n\n      ffprobe.stderr.on('close', function() {\n        stderrClosed = true;\n        handleExit();\n      });\n    });\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar fs = require('fs');\nvar path = require('path');\nvar async = require('async');\nvar utils = require('./utils');\n\n/*\n *! Capability helpers\n */\n\nvar avCodecRegexp = /^\\s*([D ])([E ])([VAS])([S ])([D ])([T ]) ([^ ]+) +(.*)$/;\nvar ffCodecRegexp = /^\\s*([D\\.])([E\\.])([VAS])([I\\.])([L\\.])([S\\.]) ([^ ]+) +(.*)$/;\nvar ffEncodersRegexp = /\\(encoders:([^\\)]+)\\)/;\nvar ffDecodersRegexp = /\\(decoders:([^\\)]+)\\)/;\nvar encodersRegexp = /^\\s*([VAS\\.])([F\\.])([S\\.])([X\\.])([B\\.])([D\\.]) ([^ ]+) +(.*)$/;\nvar formatRegexp = /^\\s*([D ])([E ])\\s+([^ ]+)\\s+(.*)$/;\nvar lineBreakRegexp = /\\r\\n|\\r|\\n/;\nvar filterRegexp = /^(?: [T\\.][S\\.][C\\.] )?([^ ]+) +(AA?|VV?|\\|)->(AA?|VV?|\\|) +(.*)$/;\n\nvar cache = {};\n\nmodule.exports = function(proto) {\n  /**\n   * Manually define the ffmpeg binary full path.\n   *\n   * @method FfmpegCommand#setFfmpegPath\n   *\n   * @param {String} ffmpegPath The full path to the ffmpeg binary.\n   * @return FfmpegCommand\n   */\n  proto.setFfmpegPath = function(ffmpegPath) {\n    cache.ffmpegPath = ffmpegPath;\n    return this;\n  };\n\n  /**\n   * Manually define the ffprobe binary full path.\n   *\n   * @method FfmpegCommand#setFfprobePath\n   *\n   * @param {String} ffprobePath The full path to the ffprobe binary.\n   * @return FfmpegCommand\n   */\n  proto.setFfprobePath = function(ffprobePath) {\n    cache.ffprobePath = ffprobePath;\n    return this;\n  };\n\n  /**\n   * Manually define the flvtool2/flvmeta binary full path.\n   *\n   * @method FfmpegCommand#setFlvtoolPath\n   *\n   * @param {String} flvtool The full path to the flvtool2 or flvmeta binary.\n   * @return FfmpegCommand\n   */\n  proto.setFlvtoolPath = function(flvtool) {\n    cache.flvtoolPath = flvtool;\n    return this;\n  };\n\n  /**\n   * Forget executable paths\n   *\n   * (only used for testing purposes)\n   *\n   * @method FfmpegCommand#_forgetPaths\n   * @private\n   */\n  proto._forgetPaths = function() {\n    delete cache.ffmpegPath;\n    delete cache.ffprobePath;\n    delete cache.flvtoolPath;\n  };\n\n  /**\n   * Check for ffmpeg availability\n   *\n   * If the FFMPEG_PATH environment variable is set, try to use it.\n   * If it is unset or incorrect, try to find ffmpeg in the PATH instead.\n   *\n   * @method FfmpegCommand#_getFfmpegPath\n   * @param {Function} callback callback with signature (err, path)\n   * @private\n   */\n  proto._getFfmpegPath = function(callback) {\n    if ('ffmpegPath' in cache) {\n      return callback(null, cache.ffmpegPath);\n    }\n\n    async.waterfall([\n      // Try FFMPEG_PATH\n      function(cb) {\n        if (process.env.FFMPEG_PATH) {\n          fs.exists(process.env.FFMPEG_PATH, function(exists) {\n            if (exists) {\n              cb(null, process.env.FFMPEG_PATH);\n            } else {\n              cb(null, '');\n            }\n          });\n        } else {\n          cb(null, '');\n        }\n      },\n\n      // Search in the PATH\n      function(ffmpeg, cb) {\n        if (ffmpeg.length) {\n          return cb(null, ffmpeg);\n        }\n\n        utils.which('ffmpeg', function(err, ffmpeg) {\n          cb(err, ffmpeg);\n        });\n      }\n    ], function(err, ffmpeg) {\n      if (err) {\n        callback(err);\n      } else {\n        callback(null, cache.ffmpegPath = (ffmpeg || ''));\n      }\n    });\n  };\n\n\n  /**\n   * Check for ffprobe availability\n   *\n   * If the FFPROBE_PATH environment variable is set, try to use it.\n   * If it is unset or incorrect, try to find ffprobe in the PATH instead.\n   * If this still fails, try to find ffprobe in the same directory as ffmpeg.\n   *\n   * @method FfmpegCommand#_getFfprobePath\n   * @param {Function} callback callback with signature (err, path)\n   * @private\n   */\n  proto._getFfprobePath = function(callback) {\n    var self = this;\n\n    if ('ffprobePath' in cache) {\n      return callback(null, cache.ffprobePath);\n    }\n\n    async.waterfall([\n      // Try FFPROBE_PATH\n      function(cb) {\n        if (process.env.FFPROBE_PATH) {\n          fs.exists(process.env.FFPROBE_PATH, function(exists) {\n            cb(null, exists ? process.env.FFPROBE_PATH : '');\n          });\n        } else {\n          cb(null, '');\n        }\n      },\n\n      // Search in the PATH\n      function(ffprobe, cb) {\n        if (ffprobe.length) {\n          return cb(null, ffprobe);\n        }\n\n        utils.which('ffprobe', function(err, ffprobe) {\n          cb(err, ffprobe);\n        });\n      },\n\n      // Search in the same directory as ffmpeg\n      function(ffprobe, cb) {\n        if (ffprobe.length) {\n          return cb(null, ffprobe);\n        }\n\n        self._getFfmpegPath(function(err, ffmpeg) {\n          if (err) {\n            cb(err);\n          } else if (ffmpeg.length) {\n            var name = utils.isWindows ? 'ffprobe.exe' : 'ffprobe';\n            var ffprobe = path.join(path.dirname(ffmpeg), name);\n            fs.exists(ffprobe, function(exists) {\n              cb(null, exists ? ffprobe : '');\n            });\n          } else {\n            cb(null, '');\n          }\n        });\n      }\n    ], function(err, ffprobe) {\n      if (err) {\n        callback(err);\n      } else {\n        callback(null, cache.ffprobePath = (ffprobe || ''));\n      }\n    });\n  };\n\n\n  /**\n   * Check for flvtool2/flvmeta availability\n   *\n   * If the FLVTOOL2_PATH or FLVMETA_PATH environment variable are set, try to use them.\n   * If both are either unset or incorrect, try to find flvtool2 or flvmeta in the PATH instead.\n   *\n   * @method FfmpegCommand#_getFlvtoolPath\n   * @param {Function} callback callback with signature (err, path)\n   * @private\n   */\n   proto._getFlvtoolPath = function(callback) {\n    if ('flvtoolPath' in cache) {\n      return callback(null, cache.flvtoolPath);\n    }\n\n    async.waterfall([\n      // Try FLVMETA_PATH\n      function(cb) {\n        if (process.env.FLVMETA_PATH) {\n          fs.exists(process.env.FLVMETA_PATH, function(exists) {\n            cb(null, exists ? process.env.FLVMETA_PATH : '');\n          });\n        } else {\n          cb(null, '');\n        }\n      },\n\n      // Try FLVTOOL2_PATH\n      function(flvtool, cb) {\n        if (flvtool.length) {\n          return cb(null, flvtool);\n        }\n\n        if (process.env.FLVTOOL2_PATH) {\n          fs.exists(process.env.FLVTOOL2_PATH, function(exists) {\n            cb(null, exists ? process.env.FLVTOOL2_PATH : '');\n          });\n        } else {\n          cb(null, '');\n        }\n      },\n\n      // Search for flvmeta in the PATH\n      function(flvtool, cb) {\n        if (flvtool.length) {\n          return cb(null, flvtool);\n        }\n\n        utils.which('flvmeta', function(err, flvmeta) {\n          cb(err, flvmeta);\n        });\n      },\n\n      // Search for flvtool2 in the PATH\n      function(flvtool, cb) {\n        if (flvtool.length) {\n          return cb(null, flvtool);\n        }\n\n        utils.which('flvtool2', function(err, flvtool2) {\n          cb(err, flvtool2);\n        });\n      },\n    ], function(err, flvtool) {\n      if (err) {\n        callback(err);\n      } else {\n        callback(null, cache.flvtoolPath = (flvtool || ''));\n      }\n    });\n  };\n\n\n  /**\n   * A callback passed to {@link FfmpegCommand#availableFilters}.\n   *\n   * @callback FfmpegCommand~filterCallback\n   * @param {Error|null} err error object or null if no error happened\n   * @param {Object} filters filter object with filter names as keys and the following\n   *   properties for each filter:\n   * @param {String} filters.description filter description\n   * @param {String} filters.input input type, one of 'audio', 'video' and 'none'\n   * @param {Boolean} filters.multipleInputs whether the filter supports multiple inputs\n   * @param {String} filters.output output type, one of 'audio', 'video' and 'none'\n   * @param {Boolean} filters.multipleOutputs whether the filter supports multiple outputs\n   */\n\n  /**\n   * Query ffmpeg for available filters\n   *\n   * @method FfmpegCommand#availableFilters\n   * @category Capabilities\n   * @aliases getAvailableFilters\n   *\n   * @param {FfmpegCommand~filterCallback} callback callback function\n   */\n  proto.availableFilters =\n  proto.getAvailableFilters = function(callback) {\n    if ('filters' in cache) {\n      return callback(null, cache.filters);\n    }\n\n    this._spawnFfmpeg(['-filters'], { captureStdout: true, stdoutLines: 0 }, function (err, stdoutRing) {\n      if (err) {\n        return callback(err);\n      }\n\n      var stdout = stdoutRing.get();\n      var lines = stdout.split('\\n');\n      var data = {};\n      var types = { A: 'audio', V: 'video', '|': 'none' };\n\n      lines.forEach(function(line) {\n        var match = line.match(filterRegexp);\n        if (match) {\n          data[match[1]] = {\n            description: match[4],\n            input: types[match[2].charAt(0)],\n            multipleInputs: match[2].length > 1,\n            output: types[match[3].charAt(0)],\n            multipleOutputs: match[3].length > 1\n          };\n        }\n      });\n\n      callback(null, cache.filters = data);\n    });\n  };\n\n\n  /**\n   * A callback passed to {@link FfmpegCommand#availableCodecs}.\n   *\n   * @callback FfmpegCommand~codecCallback\n   * @param {Error|null} err error object or null if no error happened\n   * @param {Object} codecs codec object with codec names as keys and the following\n   *   properties for each codec (more properties may be available depending on the\n   *   ffmpeg version used):\n   * @param {String} codecs.description codec description\n   * @param {Boolean} codecs.canDecode whether the codec is able to decode streams\n   * @param {Boolean} codecs.canEncode whether the codec is able to encode streams\n   */\n\n  /**\n   * Query ffmpeg for available codecs\n   *\n   * @method FfmpegCommand#availableCodecs\n   * @category Capabilities\n   * @aliases getAvailableCodecs\n   *\n   * @param {FfmpegCommand~codecCallback} callback callback function\n   */\n  proto.availableCodecs =\n  proto.getAvailableCodecs = function(callback) {\n    if ('codecs' in cache) {\n      return callback(null, cache.codecs);\n    }\n\n    this._spawnFfmpeg(['-codecs'], { captureStdout: true, stdoutLines: 0 }, function(err, stdoutRing) {\n      if (err) {\n        return callback(err);\n      }\n\n      var stdout = stdoutRing.get();\n      var lines = stdout.split(lineBreakRegexp);\n      var data = {};\n\n      lines.forEach(function(line) {\n        var match = line.match(avCodecRegexp);\n        if (match && match[7] !== '=') {\n          data[match[7]] = {\n            type: { 'V': 'video', 'A': 'audio', 'S': 'subtitle' }[match[3]],\n            description: match[8],\n            canDecode: match[1] === 'D',\n            canEncode: match[2] === 'E',\n            drawHorizBand: match[4] === 'S',\n            directRendering: match[5] === 'D',\n            weirdFrameTruncation: match[6] === 'T'\n          };\n        }\n\n        match = line.match(ffCodecRegexp);\n        if (match && match[7] !== '=') {\n          var codecData = data[match[7]] = {\n            type: { 'V': 'video', 'A': 'audio', 'S': 'subtitle' }[match[3]],\n            description: match[8],\n            canDecode: match[1] === 'D',\n            canEncode: match[2] === 'E',\n            intraFrameOnly: match[4] === 'I',\n            isLossy: match[5] === 'L',\n            isLossless: match[6] === 'S'\n          };\n\n          var encoders = codecData.description.match(ffEncodersRegexp);\n          encoders = encoders ? encoders[1].trim().split(' ') : [];\n\n          var decoders = codecData.description.match(ffDecodersRegexp);\n          decoders = decoders ? decoders[1].trim().split(' ') : [];\n\n          if (encoders.length || decoders.length) {\n            var coderData = {};\n            utils.copy(codecData, coderData);\n            delete coderData.canEncode;\n            delete coderData.canDecode;\n\n            encoders.forEach(function(name) {\n              data[name] = {};\n              utils.copy(coderData, data[name]);\n              data[name].canEncode = true;\n            });\n\n            decoders.forEach(function(name) {\n              if (name in data) {\n                data[name].canDecode = true;\n              } else {\n                data[name] = {};\n                utils.copy(coderData, data[name]);\n                data[name].canDecode = true;\n              }\n            });\n          }\n        }\n      });\n\n      callback(null, cache.codecs = data);\n    });\n  };\n\n\n  /**\n   * A callback passed to {@link FfmpegCommand#availableEncoders}.\n   *\n   * @callback FfmpegCommand~encodersCallback\n   * @param {Error|null} err error object or null if no error happened\n   * @param {Object} encoders encoders object with encoder names as keys and the following\n   *   properties for each encoder:\n   * @param {String} encoders.description codec description\n   * @param {Boolean} encoders.type \"audio\", \"video\" or \"subtitle\"\n   * @param {Boolean} encoders.frameMT whether the encoder is able to do frame-level multithreading\n   * @param {Boolean} encoders.sliceMT whether the encoder is able to do slice-level multithreading\n   * @param {Boolean} encoders.experimental whether the encoder is experimental\n   * @param {Boolean} encoders.drawHorizBand whether the encoder supports draw_horiz_band\n   * @param {Boolean} encoders.directRendering whether the encoder supports direct encoding method 1\n   */\n\n  /**\n   * Query ffmpeg for available encoders\n   *\n   * @method FfmpegCommand#availableEncoders\n   * @category Capabilities\n   * @aliases getAvailableEncoders\n   *\n   * @param {FfmpegCommand~encodersCallback} callback callback function\n   */\n  proto.availableEncoders =\n  proto.getAvailableEncoders = function(callback) {\n    if ('encoders' in cache) {\n      return callback(null, cache.encoders);\n    }\n\n    this._spawnFfmpeg(['-encoders'], { captureStdout: true, stdoutLines: 0 }, function(err, stdoutRing) {\n      if (err) {\n        return callback(err);\n      }\n\n      var stdout = stdoutRing.get();\n      var lines = stdout.split(lineBreakRegexp);\n      var data = {};\n\n      lines.forEach(function(line) {\n        var match = line.match(encodersRegexp);\n        if (match && match[7] !== '=') {\n          data[match[7]] = {\n            type: { 'V': 'video', 'A': 'audio', 'S': 'subtitle' }[match[1]],\n            description: match[8],\n            frameMT: match[2] === 'F',\n            sliceMT: match[3] === 'S',\n            experimental: match[4] === 'X',\n            drawHorizBand: match[5] === 'B',\n            directRendering: match[6] === 'D'\n          };\n        }\n      });\n\n      callback(null, cache.encoders = data);\n    });\n  };\n\n\n  /**\n   * A callback passed to {@link FfmpegCommand#availableFormats}.\n   *\n   * @callback FfmpegCommand~formatCallback\n   * @param {Error|null} err error object or null if no error happened\n   * @param {Object} formats format object with format names as keys and the following\n   *   properties for each format:\n   * @param {String} formats.description format description\n   * @param {Boolean} formats.canDemux whether the format is able to demux streams from an input file\n   * @param {Boolean} formats.canMux whether the format is able to mux streams into an output file\n   */\n\n  /**\n   * Query ffmpeg for available formats\n   *\n   * @method FfmpegCommand#availableFormats\n   * @category Capabilities\n   * @aliases getAvailableFormats\n   *\n   * @param {FfmpegCommand~formatCallback} callback callback function\n   */\n  proto.availableFormats =\n  proto.getAvailableFormats = function(callback) {\n    if ('formats' in cache) {\n      return callback(null, cache.formats);\n    }\n\n    // Run ffmpeg -formats\n    this._spawnFfmpeg(['-formats'], { captureStdout: true, stdoutLines: 0 }, function (err, stdoutRing) {\n      if (err) {\n        return callback(err);\n      }\n\n      // Parse output\n      var stdout = stdoutRing.get();\n      var lines = stdout.split(lineBreakRegexp);\n      var data = {};\n\n      lines.forEach(function(line) {\n        var match = line.match(formatRegexp);\n        if (match) {\n          match[3].split(',').forEach(function(format) {\n            if (!(format in data)) {\n              data[format] = {\n                description: match[4],\n                canDemux: false,\n                canMux: false\n              };\n            }\n\n            if (match[1] === 'D') {\n              data[format].canDemux = true;\n            }\n            if (match[2] === 'E') {\n              data[format].canMux = true;\n            }\n          });\n        }\n      });\n\n      callback(null, cache.formats = data);\n    });\n  };\n\n\n  /**\n   * Check capabilities before executing a command\n   *\n   * Checks whether all used codecs and formats are indeed available\n   *\n   * @method FfmpegCommand#_checkCapabilities\n   * @param {Function} callback callback with signature (err)\n   * @private\n   */\n  proto._checkCapabilities = function(callback) {\n    var self = this;\n    async.waterfall([\n      // Get available formats\n      function(cb) {\n        self.availableFormats(cb);\n      },\n\n      // Check whether specified formats are available\n      function(formats, cb) {\n        var unavailable;\n\n        // Output format(s)\n        unavailable = self._outputs\n          .reduce(function(fmts, output) {\n            var format = output.options.find('-f', 1);\n            if (format) {\n              if (!(format[0] in formats) || !(formats[format[0]].canMux)) {\n                fmts.push(format);\n              }\n            }\n\n            return fmts;\n          }, []);\n\n        if (unavailable.length === 1) {\n          return cb(new Error('Output format ' + unavailable[0] + ' is not available'));\n        } else if (unavailable.length > 1) {\n          return cb(new Error('Output formats ' + unavailable.join(', ') + ' are not available'));\n        }\n\n        // Input format(s)\n        unavailable = self._inputs\n          .reduce(function(fmts, input) {\n            var format = input.options.find('-f', 1);\n            if (format) {\n              if (!(format[0] in formats) || !(formats[format[0]].canDemux)) {\n                fmts.push(format[0]);\n              }\n            }\n\n            return fmts;\n          }, []);\n\n        if (unavailable.length === 1) {\n          return cb(new Error('Input format ' + unavailable[0] + ' is not available'));\n        } else if (unavailable.length > 1) {\n          return cb(new Error('Input formats ' + unavailable.join(', ') + ' are not available'));\n        }\n\n        cb();\n      },\n\n      // Get available codecs\n      function(cb) {\n        self.availableEncoders(cb);\n      },\n\n      // Check whether specified codecs are available and add strict experimental options if needed\n      function(encoders, cb) {\n        var unavailable;\n\n        // Audio codec(s)\n        unavailable = self._outputs.reduce(function(cdcs, output) {\n          var acodec = output.audio.find('-acodec', 1);\n          if (acodec && acodec[0] !== 'copy') {\n            if (!(acodec[0] in encoders) || encoders[acodec[0]].type !== 'audio') {\n              cdcs.push(acodec[0]);\n            }\n          }\n\n          return cdcs;\n        }, []);\n\n        if (unavailable.length === 1) {\n          return cb(new Error('Audio codec ' + unavailable[0] + ' is not available'));\n        } else if (unavailable.length > 1) {\n          return cb(new Error('Audio codecs ' + unavailable.join(', ') + ' are not available'));\n        }\n\n        // Video codec(s)\n        unavailable = self._outputs.reduce(function(cdcs, output) {\n          var vcodec = output.video.find('-vcodec', 1);\n          if (vcodec && vcodec[0] !== 'copy') {\n            if (!(vcodec[0] in encoders) || encoders[vcodec[0]].type !== 'video') {\n              cdcs.push(vcodec[0]);\n            }\n          }\n\n          return cdcs;\n        }, []);\n\n        if (unavailable.length === 1) {\n          return cb(new Error('Video codec ' + unavailable[0] + ' is not available'));\n        } else if (unavailable.length > 1) {\n          return cb(new Error('Video codecs ' + unavailable.join(', ') + ' are not available'));\n        }\n\n        cb();\n      }\n    ], callback);\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar exec = require('child_process').exec;\nvar isWindows = require('os').platform().match(/win(32|64)/);\nvar which = require('which');\n\nvar nlRegexp = /\\r\\n|\\r|\\n/g;\nvar streamRegexp = /^\\[?(.*?)\\]?$/;\nvar filterEscapeRegexp = /[,]/;\nvar whichCache = {};\n\n/**\n * Parse progress line from ffmpeg stderr\n *\n * @param {String} line progress line\n * @return progress object\n * @private\n */\nfunction parseProgressLine(line) {\n  var progress = {};\n\n  // Remove all spaces after = and trim\n  line  = line.replace(/=\\s+/g, '=').trim();\n  var progressParts = line.split(' ');\n\n  // Split every progress part by \"=\" to get key and value\n  for(var i = 0; i < progressParts.length; i++) {\n    var progressSplit = progressParts[i].split('=', 2);\n    var key = progressSplit[0];\n    var value = progressSplit[1];\n\n    // This is not a progress line\n    if(typeof value === 'undefined')\n      return null;\n\n    progress[key] = value;\n  }\n\n  return progress;\n}\n\n\nvar utils = module.exports = {\n  isWindows: isWindows,\n  streamRegexp: streamRegexp,\n\n\n  /**\n   * Copy an object keys into another one\n   *\n   * @param {Object} source source object\n   * @param {Object} dest destination object\n   * @private\n   */\n  copy: function(source, dest) {\n    Object.keys(source).forEach(function(key) {\n      dest[key] = source[key];\n    });\n  },\n\n\n  /**\n   * Create an argument list\n   *\n   * Returns a function that adds new arguments to the list.\n   * It also has the following methods:\n   * - clear() empties the argument list\n   * - get() returns the argument list\n   * - find(arg, count) finds 'arg' in the list and return the following 'count' items, or undefined if not found\n   * - remove(arg, count) remove 'arg' in the list as well as the following 'count' items\n   *\n   * @private\n   */\n  args: function() {\n    var list = [];\n\n    // Append argument(s) to the list\n    var argfunc = function() {\n      if (arguments.length === 1 && Array.isArray(arguments[0])) {\n        list = list.concat(arguments[0]);\n      } else {\n        list = list.concat([].slice.call(arguments));\n      }\n    };\n\n    // Clear argument list\n    argfunc.clear = function() {\n      list = [];\n    };\n\n    // Return argument list\n    argfunc.get = function() {\n      return list;\n    };\n\n    // Find argument 'arg' in list, and if found, return an array of the 'count' items that follow it\n    argfunc.find = function(arg, count) {\n      var index = list.indexOf(arg);\n      if (index !== -1) {\n        return list.slice(index + 1, index + 1 + (count || 0));\n      }\n    };\n\n    // Find argument 'arg' in list, and if found, remove it as well as the 'count' items that follow it\n    argfunc.remove = function(arg, count) {\n      var index = list.indexOf(arg);\n      if (index !== -1) {\n        list.splice(index, (count || 0) + 1);\n      }\n    };\n\n    // Clone argument list\n    argfunc.clone = function() {\n      var cloned = utils.args();\n      cloned(list);\n      return cloned;\n    };\n\n    return argfunc;\n  },\n\n\n  /**\n   * Generate filter strings\n   *\n   * @param {String[]|Object[]} filters filter specifications. When using objects,\n   *   each must have the following properties:\n   * @param {String} filters.filter filter name\n   * @param {String|Array} [filters.inputs] (array of) input stream specifier(s) for the filter,\n   *   defaults to ffmpeg automatically choosing the first unused matching streams\n   * @param {String|Array} [filters.outputs] (array of) output stream specifier(s) for the filter,\n   *   defaults to ffmpeg automatically assigning the output to the output file\n   * @param {Object|String|Array} [filters.options] filter options, can be omitted to not set any options\n   * @return String[]\n   * @private\n   */\n  makeFilterStrings: function(filters) {\n    return filters.map(function(filterSpec) {\n      if (typeof filterSpec === 'string') {\n        return filterSpec;\n      }\n\n      var filterString = '';\n\n      // Filter string format is:\n      // [input1][input2]...filter[output1][output2]...\n      // The 'filter' part can optionaly have arguments:\n      //   filter=arg1:arg2:arg3\n      //   filter=arg1=v1:arg2=v2:arg3=v3\n\n      // Add inputs\n      if (Array.isArray(filterSpec.inputs)) {\n        filterString += filterSpec.inputs.map(function(streamSpec) {\n          return streamSpec.replace(streamRegexp, '[$1]');\n        }).join('');\n      } else if (typeof filterSpec.inputs === 'string') {\n        filterString += filterSpec.inputs.replace(streamRegexp, '[$1]');\n      }\n\n      // Add filter\n      filterString += filterSpec.filter;\n\n      // Add options\n      if (filterSpec.options) {\n        if (typeof filterSpec.options === 'string' || typeof filterSpec.options === 'number') {\n          // Option string\n          filterString += '=' + filterSpec.options;\n        } else if (Array.isArray(filterSpec.options)) {\n          // Option array (unnamed options)\n          filterString += '=' + filterSpec.options.map(function(option) {\n            if (typeof option === 'string' && option.match(filterEscapeRegexp)) {\n              return '\\'' + option + '\\'';\n            } else {\n              return option;\n            }\n          }).join(':');\n        } else if (Object.keys(filterSpec.options).length) {\n          // Option object (named options)\n          filterString += '=' + Object.keys(filterSpec.options).map(function(option) {\n            var value = filterSpec.options[option];\n\n            if (typeof value === 'string' && value.match(filterEscapeRegexp)) {\n              value = '\\'' + value + '\\'';\n            }\n\n            return option + '=' + value;\n          }).join(':');\n        }\n      }\n\n      // Add outputs\n      if (Array.isArray(filterSpec.outputs)) {\n        filterString += filterSpec.outputs.map(function(streamSpec) {\n          return streamSpec.replace(streamRegexp, '[$1]');\n        }).join('');\n      } else if (typeof filterSpec.outputs === 'string') {\n        filterString += filterSpec.outputs.replace(streamRegexp, '[$1]');\n      }\n\n      return filterString;\n    });\n  },\n\n\n  /**\n   * Search for an executable\n   *\n   * Uses 'which' or 'where' depending on platform\n   *\n   * @param {String} name executable name\n   * @param {Function} callback callback with signature (err, path)\n   * @private\n   */\n  which: function(name, callback) {\n    if (name in whichCache) {\n      return callback(null, whichCache[name]);\n    }\n\n    which(name, function(err, result){\n      if (err) {\n        // Treat errors as not found\n        return callback(null, whichCache[name] = '');\n      }\n      callback(null, whichCache[name] = result);\n    });\n  },\n\n\n  /**\n   * Convert a [[hh:]mm:]ss[.xxx] timemark into seconds\n   *\n   * @param {String} timemark timemark string\n   * @return Number\n   * @private\n   */\n  timemarkToSeconds: function(timemark) {\n    if (typeof timemark === 'number') {\n      return timemark;\n    }\n\n    if (timemark.indexOf(':') === -1 && timemark.indexOf('.') >= 0) {\n      return Number(timemark);\n    }\n\n    var parts = timemark.split(':');\n\n    // add seconds\n    var secs = Number(parts.pop());\n\n    if (parts.length) {\n      // add minutes\n      secs += Number(parts.pop()) * 60;\n    }\n\n    if (parts.length) {\n      // add hours\n      secs += Number(parts.pop()) * 3600;\n    }\n\n    return secs;\n  },\n\n\n  /**\n   * Extract codec data from ffmpeg stderr and emit 'codecData' event if appropriate\n   * Call it with an initially empty codec object once with each line of stderr output until it returns true\n   *\n   * @param {FfmpegCommand} command event emitter\n   * @param {String} stderrLine ffmpeg stderr output line\n   * @param {Object} codecObject object used to accumulate codec data between calls\n   * @return {Boolean} true if codec data is complete (and event was emitted), false otherwise\n   * @private\n   */\n  extractCodecData: function(command, stderrLine, codecsObject) {\n    var inputPattern = /Input #[0-9]+, ([^ ]+),/;\n    var durPattern = /Duration\\: ([^,]+)/;\n    var audioPattern = /Audio\\: (.*)/;\n    var videoPattern = /Video\\: (.*)/;\n\n    if (!('inputStack' in codecsObject)) {\n      codecsObject.inputStack = [];\n      codecsObject.inputIndex = -1;\n      codecsObject.inInput = false;\n    }\n\n    var inputStack = codecsObject.inputStack;\n    var inputIndex = codecsObject.inputIndex;\n    var inInput = codecsObject.inInput;\n\n    var format, dur, audio, video;\n\n    if (format = stderrLine.match(inputPattern)) {\n      inInput = codecsObject.inInput = true;\n      inputIndex = codecsObject.inputIndex = codecsObject.inputIndex + 1;\n\n      inputStack[inputIndex] = { format: format[1], audio: '', video: '', duration: '' };\n    } else if (inInput && (dur = stderrLine.match(durPattern))) {\n      inputStack[inputIndex].duration = dur[1];\n    } else if (inInput && (audio = stderrLine.match(audioPattern))) {\n      audio = audio[1].split(', ');\n      inputStack[inputIndex].audio = audio[0];\n      inputStack[inputIndex].audio_details = audio;\n    } else if (inInput && (video = stderrLine.match(videoPattern))) {\n      video = video[1].split(', ');\n      inputStack[inputIndex].video = video[0];\n      inputStack[inputIndex].video_details = video;\n    } else if (/Output #\\d+/.test(stderrLine)) {\n      inInput = codecsObject.inInput = false;\n    } else if (/Stream mapping:|Press (\\[q\\]|ctrl-c) to stop/.test(stderrLine)) {\n      command.emit.apply(command, ['codecData'].concat(inputStack));\n      return true;\n    }\n\n    return false;\n  },\n\n\n  /**\n   * Extract progress data from ffmpeg stderr and emit 'progress' event if appropriate\n   *\n   * @param {FfmpegCommand} command event emitter\n   * @param {String} stderrLine ffmpeg stderr data\n   * @private\n   */\n  extractProgress: function(command, stderrLine) {\n    var progress = parseProgressLine(stderrLine);\n\n    if (progress) {\n      // build progress report object\n      var ret = {\n        frames: parseInt(progress.frame, 10),\n        currentFps: parseInt(progress.fps, 10),\n        currentKbps: progress.bitrate ? parseFloat(progress.bitrate.replace('kbits/s', '')) : 0,\n        targetSize: parseInt(progress.size || progress.Lsize, 10),\n        timemark: progress.time\n      };\n\n      // calculate percent progress using duration\n      if (command._ffprobeData && command._ffprobeData.format && command._ffprobeData.format.duration) {\n        var duration = Number(command._ffprobeData.format.duration);\n        if (!isNaN(duration))\n          ret.percent = (utils.timemarkToSeconds(ret.timemark) / duration) * 100;\n      }\n      command.emit('progress', ret);\n    }\n  },\n\n\n  /**\n   * Extract error message(s) from ffmpeg stderr\n   *\n   * @param {String} stderr ffmpeg stderr data\n   * @return {String}\n   * @private\n   */\n  extractError: function(stderr) {\n    // Only return the last stderr lines that don't start with a space or a square bracket\n    return stderr.split(nlRegexp).reduce(function(messages, message) {\n      if (message.charAt(0) === ' ' || message.charAt(0) === '[') {\n        return [];\n      } else {\n        messages.push(message);\n        return messages;\n      }\n    }, []).join('\\n');\n  },\n\n\n  /**\n   * Creates a line ring buffer object with the following methods:\n   * - append(str) : appends a string or buffer\n   * - get() : returns the whole string\n   * - close() : prevents further append() calls and does a last call to callbacks\n   * - callback(cb) : calls cb for each line (incl. those already in the ring)\n   *\n   * @param {Number} maxLines maximum number of lines to store (<= 0 for unlimited)\n   */\n  linesRing: function(maxLines) {\n    var cbs = [];\n    var lines = [];\n    var current = null;\n    var closed = false\n    var max = maxLines - 1;\n\n    function emit(line) {\n      cbs.forEach(function(cb) { cb(line); });\n    }\n\n    return {\n      callback: function(cb) {\n        lines.forEach(function(l) { cb(l); });\n        cbs.push(cb);\n      },\n\n      append: function(str) {\n        if (closed) return;\n        if (str instanceof Buffer) str = '' + str;\n        if (!str || str.length === 0) return;\n\n        var newLines = str.split(nlRegexp);\n\n        if (newLines.length === 1) {\n          if (current !== null) {\n            current = current + newLines.shift();\n          } else {\n            current = newLines.shift();\n          }\n        } else {\n          if (current !== null) {\n            current = current + newLines.shift();\n            emit(current);\n            lines.push(current);\n          }\n\n          current = newLines.pop();\n\n          newLines.forEach(function(l) {\n            emit(l);\n            lines.push(l);\n          });\n\n          if (max > -1 && lines.length > max) {\n            lines.splice(0, lines.length - max);\n          }\n        }\n      },\n\n      get: function() {\n        if (current !== null) {\n          return lines.concat([current]).join('\\n');\n        } else {\n          return lines.join('\\n');\n        }\n      },\n\n      close: function() {\n        if (closed) return;\n\n        if (current !== null) {\n          emit(current);\n          lines.push(current);\n\n          if (max > -1 && lines.length > max) {\n            lines.shift();\n          }\n\n          current = null;\n        }\n\n        closed = true;\n      }\n    };\n  }\n};\n","/*jshint node:true*/\n'use strict';\n\nvar spawn = require('child_process').spawn;\nvar path = require('path');\nvar fs = require('fs');\nvar async = require('async');\nvar utils = require('./utils');\n\n/*\n *! Processor methods\n */\n\n\n/**\n * Run ffprobe asynchronously and store data in command\n *\n * @param {FfmpegCommand} command\n * @private\n */\nfunction runFfprobe(command) {\n  const inputProbeIndex = 0;\n  if (command._inputs[inputProbeIndex].isStream) {\n    // Don't probe input streams as this will consume them\n    return;\n  }\n  command.ffprobe(inputProbeIndex, function(err, data) {\n    command._ffprobeData = data;\n  });\n}\n\n\nmodule.exports = function(proto) {\n  /**\n   * Emitted just after ffmpeg has been spawned.\n   *\n   * @event FfmpegCommand#start\n   * @param {String} command ffmpeg command line\n   */\n\n  /**\n   * Emitted when ffmpeg reports progress information\n   *\n   * @event FfmpegCommand#progress\n   * @param {Object} progress progress object\n   * @param {Number} progress.frames number of frames transcoded\n   * @param {Number} progress.currentFps current processing speed in frames per second\n   * @param {Number} progress.currentKbps current output generation speed in kilobytes per second\n   * @param {Number} progress.targetSize current output file size\n   * @param {String} progress.timemark current video timemark\n   * @param {Number} [progress.percent] processing progress (may not be available depending on input)\n   */\n\n  /**\n   * Emitted when ffmpeg outputs to stderr\n   *\n   * @event FfmpegCommand#stderr\n   * @param {String} line stderr output line\n   */\n\n  /**\n   * Emitted when ffmpeg reports input codec data\n   *\n   * @event FfmpegCommand#codecData\n   * @param {Object} codecData codec data object\n   * @param {String} codecData.format input format name\n   * @param {String} codecData.audio input audio codec name\n   * @param {String} codecData.audio_details input audio codec parameters\n   * @param {String} codecData.video input video codec name\n   * @param {String} codecData.video_details input video codec parameters\n   */\n\n  /**\n   * Emitted when an error happens when preparing or running a command\n   *\n   * @event FfmpegCommand#error\n   * @param {Error} error error object, with optional properties 'inputStreamError' / 'outputStreamError' for errors on their respective streams\n   * @param {String|null} stdout ffmpeg stdout, unless outputting to a stream\n   * @param {String|null} stderr ffmpeg stderr\n   */\n\n  /**\n   * Emitted when a command finishes processing\n   *\n   * @event FfmpegCommand#end\n   * @param {Array|String|null} [filenames|stdout] generated filenames when taking screenshots, ffmpeg stdout when not outputting to a stream, null otherwise\n   * @param {String|null} stderr ffmpeg stderr\n   */\n\n\n  /**\n   * Spawn an ffmpeg process\n   *\n   * The 'options' argument may contain the following keys:\n   * - 'niceness': specify process niceness, ignored on Windows (default: 0)\n   * - `cwd`: change working directory\n   * - 'captureStdout': capture stdout and pass it to 'endCB' as its 2nd argument (default: false)\n   * - 'stdoutLines': override command limit (default: use command limit)\n   *\n   * The 'processCB' callback, if present, is called as soon as the process is created and\n   * receives a nodejs ChildProcess object.  It may not be called at all if an error happens\n   * before spawning the process.\n   *\n   * The 'endCB' callback is called either when an error occurs or when the ffmpeg process finishes.\n   *\n   * @method FfmpegCommand#_spawnFfmpeg\n   * @param {Array} args ffmpeg command line argument list\n   * @param {Object} [options] spawn options (see above)\n   * @param {Function} [processCB] callback called with process object and stdout/stderr ring buffers when process has been created\n   * @param {Function} endCB callback called with error (if applicable) and stdout/stderr ring buffers when process finished\n   * @private\n   */\n  proto._spawnFfmpeg = function(args, options, processCB, endCB) {\n    // Enable omitting options\n    if (typeof options === 'function') {\n      endCB = processCB;\n      processCB = options;\n      options = {};\n    }\n\n    // Enable omitting processCB\n    if (typeof endCB === 'undefined') {\n      endCB = processCB;\n      processCB = function() {};\n    }\n\n    var maxLines = 'stdoutLines' in options ? options.stdoutLines : this.options.stdoutLines;\n\n    // Find ffmpeg\n    this._getFfmpegPath(function(err, command) {\n      if (err) {\n        return endCB(err);\n      } else if (!command || command.length === 0) {\n        return endCB(new Error('Cannot find ffmpeg'));\n      }\n\n      // Apply niceness\n      if (options.niceness && options.niceness !== 0 && !utils.isWindows) {\n        args.unshift('-n', options.niceness, command);\n        command = 'nice';\n      }\n\n      var stdoutRing = utils.linesRing(maxLines);\n      var stdoutClosed = false;\n\n      var stderrRing = utils.linesRing(maxLines);\n      var stderrClosed = false;\n\n      // Spawn process\n      var ffmpegProc = spawn(command, args, options);\n\n      if (ffmpegProc.stderr) {\n        ffmpegProc.stderr.setEncoding('utf8');\n      }\n\n      ffmpegProc.on('error', function(err) {\n        endCB(err);\n      });\n\n      // Ensure we wait for captured streams to end before calling endCB\n      var exitError = null;\n      function handleExit(err) {\n        if (err) {\n          exitError = err;\n        }\n\n        if (processExited && (stdoutClosed || !options.captureStdout) && stderrClosed) {\n          endCB(exitError, stdoutRing, stderrRing);\n        }\n      }\n\n      // Handle process exit\n      var processExited = false;\n      ffmpegProc.on('exit', function(code, signal) {\n        processExited = true;\n\n        if (signal) {\n          handleExit(new Error('ffmpeg was killed with signal ' + signal));\n        } else if (code) {\n          handleExit(new Error('ffmpeg exited with code ' + code));\n        } else {\n          handleExit();\n        }\n      });\n\n      // Capture stdout if specified\n      if (options.captureStdout) {\n        ffmpegProc.stdout.on('data', function(data) {\n          stdoutRing.append(data);\n        });\n\n        ffmpegProc.stdout.on('close', function() {\n          stdoutRing.close();\n          stdoutClosed = true;\n          handleExit();\n        });\n      }\n\n      // Capture stderr if specified\n      ffmpegProc.stderr.on('data', function(data) {\n        stderrRing.append(data);\n      });\n\n      ffmpegProc.stderr.on('close', function() {\n        stderrRing.close();\n        stderrClosed = true;\n        handleExit();\n      });\n\n      // Call process callback\n      processCB(ffmpegProc, stdoutRing, stderrRing);\n    });\n  };\n\n\n  /**\n   * Build the argument list for an ffmpeg command\n   *\n   * @method FfmpegCommand#_getArguments\n   * @return argument list\n   * @private\n   */\n  proto._getArguments = function() {\n    var complexFilters = this._complexFilters.get();\n\n    var fileOutput = this._outputs.some(function(output) {\n      return output.isFile;\n    });\n\n    return [].concat(\n        // Inputs and input options\n        this._inputs.reduce(function(args, input) {\n          var source = (typeof input.source === 'string') ? input.source : 'pipe:0';\n\n          // For each input, add input options, then '-i <source>'\n          return args.concat(\n            input.options.get(),\n            ['-i', source]\n          );\n        }, []),\n\n        // Global options\n        this._global.get(),\n\n        // Overwrite if we have file outputs\n        fileOutput ? ['-y'] : [],\n\n        // Complex filters\n        complexFilters,\n\n        // Outputs, filters and output options\n        this._outputs.reduce(function(args, output) {\n          var sizeFilters = utils.makeFilterStrings(output.sizeFilters.get());\n          var audioFilters = output.audioFilters.get();\n          var videoFilters = output.videoFilters.get().concat(sizeFilters);\n          var outputArg;\n\n          if (!output.target) {\n            outputArg = [];\n          } else if (typeof output.target === 'string') {\n            outputArg = [output.target];\n          } else {\n            outputArg = ['pipe:1'];\n          }\n\n          return args.concat(\n            output.audio.get(),\n            audioFilters.length ? ['-filter:a', audioFilters.join(',')] : [],\n            output.video.get(),\n            videoFilters.length ? ['-filter:v', videoFilters.join(',')] : [],\n            output.options.get(),\n            outputArg\n          );\n        }, [])\n      );\n  };\n\n\n  /**\n   * Prepare execution of an ffmpeg command\n   *\n   * Checks prerequisites for the execution of the command (codec/format availability, flvtool...),\n   * then builds the argument list for ffmpeg and pass them to 'callback'.\n   *\n   * @method FfmpegCommand#_prepare\n   * @param {Function} callback callback with signature (err, args)\n   * @param {Boolean} [readMetadata=false] read metadata before processing\n   * @private\n   */\n  proto._prepare = function(callback, readMetadata) {\n    var self = this;\n\n    async.waterfall([\n      // Check codecs and formats\n      function(cb) {\n        self._checkCapabilities(cb);\n      },\n\n      // Read metadata if required\n      function(cb) {\n        if (!readMetadata) {\n          return cb();\n        }\n\n        self.ffprobe(0, function(err, data) {\n          if (!err) {\n            self._ffprobeData = data;\n          }\n\n          cb();\n        });\n      },\n\n      // Check for flvtool2/flvmeta if necessary\n      function(cb) {\n        var flvmeta = self._outputs.some(function(output) {\n          // Remove flvmeta flag on non-file output\n          if (output.flags.flvmeta && !output.isFile) {\n            self.logger.warn('Updating flv metadata is only supported for files');\n            output.flags.flvmeta = false;\n          }\n\n          return output.flags.flvmeta;\n        });\n\n        if (flvmeta) {\n          self._getFlvtoolPath(function(err) {\n            cb(err);\n          });\n        } else {\n          cb();\n        }\n      },\n\n      // Build argument list\n      function(cb) {\n        var args;\n        try {\n          args = self._getArguments();\n        } catch(e) {\n          return cb(e);\n        }\n\n        cb(null, args);\n      },\n\n      // Add \"-strict experimental\" option where needed\n      function(args, cb) {\n        self.availableEncoders(function(err, encoders) {\n          for (var i = 0; i < args.length; i++) {\n            if (args[i] === '-acodec' || args[i] === '-vcodec') {\n              i++;\n\n              if ((args[i] in encoders) && encoders[args[i]].experimental) {\n                args.splice(i + 1, 0, '-strict', 'experimental');\n                i += 2;\n              }\n            }\n          }\n\n          cb(null, args);\n        });\n      }\n    ], callback);\n\n    if (!readMetadata) {\n      // Read metadata as soon as 'progress' listeners are added\n\n      if (this.listeners('progress').length > 0) {\n        // Read metadata in parallel\n        runFfprobe(this);\n      } else {\n        // Read metadata as soon as the first 'progress' listener is added\n        this.once('newListener', function(event) {\n          if (event === 'progress') {\n            runFfprobe(this);\n          }\n        });\n      }\n    }\n  };\n\n\n  /**\n   * Run ffmpeg command\n   *\n   * @method FfmpegCommand#run\n   * @category Processing\n   * @aliases exec,execute\n   */\n  proto.exec =\n  proto.execute =\n  proto.run = function() {\n    var self = this;\n\n    // Check if at least one output is present\n    var outputPresent = this._outputs.some(function(output) {\n      return 'target' in output;\n    });\n\n    if (!outputPresent) {\n      throw new Error('No output specified');\n    }\n\n    // Get output stream if any\n    var outputStream = this._outputs.filter(function(output) {\n      return typeof output.target !== 'string';\n    })[0];\n\n    // Get input stream if any\n    var inputStream = this._inputs.filter(function(input) {\n      return typeof input.source !== 'string';\n    })[0];\n\n    // Ensure we send 'end' or 'error' only once\n    var ended = false;\n    function emitEnd(err, stdout, stderr) {\n      if (!ended) {\n        ended = true;\n\n        if (err) {\n          self.emit('error', err, stdout, stderr);\n        } else {\n          self.emit('end', stdout, stderr);\n        }\n      }\n    }\n\n    self._prepare(function(err, args) {\n      if (err) {\n        return emitEnd(err);\n      }\n\n      // Run ffmpeg\n      self._spawnFfmpeg(\n        args,\n        {\n          captureStdout: !outputStream,\n          niceness: self.options.niceness,\n          cwd: self.options.cwd,\n          windowsHide: true\n        }, \n\n        function processCB(ffmpegProc, stdoutRing, stderrRing) {\n          self.ffmpegProc = ffmpegProc;\n          self.emit('start', 'ffmpeg ' + args.join(' '));\n\n          // Pipe input stream if any\n          if (inputStream) {\n            inputStream.source.on('error', function(err) {\n              var reportingErr = new Error('Input stream error: ' + err.message);\n              reportingErr.inputStreamError = err;\n              emitEnd(reportingErr);\n              ffmpegProc.kill();\n            });\n\n            inputStream.source.resume();\n            inputStream.source.pipe(ffmpegProc.stdin);\n\n            // Set stdin error handler on ffmpeg (prevents nodejs catching the error, but\n            // ffmpeg will fail anyway, so no need to actually handle anything)\n            ffmpegProc.stdin.on('error', function() {});\n          }\n\n          // Setup timeout if requested\n          if (self.options.timeout) {\n            self.processTimer = setTimeout(function() {\n              var msg = 'process ran into a timeout (' + self.options.timeout + 's)';\n\n              emitEnd(new Error(msg), stdoutRing.get(), stderrRing.get());\n              ffmpegProc.kill();\n            }, self.options.timeout * 1000);\n          }\n\n\n          if (outputStream) {\n            // Pipe ffmpeg stdout to output stream\n            ffmpegProc.stdout.pipe(outputStream.target, outputStream.pipeopts);\n\n            // Handle output stream events\n            outputStream.target.on('close', function() {\n              self.logger.debug('Output stream closed, scheduling kill for ffmpeg process');\n\n              // Don't kill process yet, to give a chance to ffmpeg to\n              // terminate successfully first  This is necessary because\n              // under load, the process 'exit' event sometimes happens\n              // after the output stream 'close' event.\n              setTimeout(function() {\n                emitEnd(new Error('Output stream closed'));\n                ffmpegProc.kill();\n              }, 20);\n            });\n\n            outputStream.target.on('error', function(err) {\n              self.logger.debug('Output stream error, killing ffmpeg process');\n              var reportingErr = new Error('Output stream error: ' + err.message);\n              reportingErr.outputStreamError = err;\n              emitEnd(reportingErr, stdoutRing.get(), stderrRing.get());\n              ffmpegProc.kill('SIGKILL');\n            });\n          }\n\n          // Setup stderr handling\n          if (stderrRing) {\n\n            // 'stderr' event\n            if (self.listeners('stderr').length) {\n              stderrRing.callback(function(line) {\n                self.emit('stderr', line);\n              });\n            }\n\n            // 'codecData' event\n            if (self.listeners('codecData').length) {\n              var codecDataSent = false;\n              var codecObject = {};\n\n              stderrRing.callback(function(line) {\n                if (!codecDataSent)\n                  codecDataSent = utils.extractCodecData(self, line, codecObject);\n              });\n            }\n\n            // 'progress' event\n            if (self.listeners('progress').length) {\n              stderrRing.callback(function(line) {\n                utils.extractProgress(self, line);\n              });\n            }\n          }\n        },\n\n        function endCB(err, stdoutRing, stderrRing) {\n          clearTimeout(self.processTimer);\n          delete self.ffmpegProc;\n\n          if (err) {\n            if (err.message.match(/ffmpeg exited with code/)) {\n              // Add ffmpeg error message\n              err.message += ': ' + utils.extractError(stderrRing.get());\n            }\n\n            emitEnd(err, stdoutRing.get(), stderrRing.get());\n          } else {\n            // Find out which outputs need flv metadata\n            var flvmeta = self._outputs.filter(function(output) {\n              return output.flags.flvmeta;\n            });\n\n            if (flvmeta.length) {\n              self._getFlvtoolPath(function(err, flvtool) {\n                if (err) {\n                  return emitEnd(err);\n                }\n\n                async.each(\n                  flvmeta,\n                  function(output, cb) {\n                    spawn(flvtool, ['-U', output.target], {windowsHide: true})\n                      .on('error', function(err) {\n                        cb(new Error('Error running ' + flvtool + ' on ' + output.target + ': ' + err.message));\n                      })\n                      .on('exit', function(code, signal) {\n                        if (code !== 0 || signal) {\n                          cb(\n                            new Error(flvtool + ' ' +\n                              (signal ? 'received signal ' + signal\n                                      : 'exited with code ' + code)) +\n                              ' when running on ' + output.target\n                          );\n                        } else {\n                          cb();\n                        }\n                      });\n                  },\n                  function(err) {\n                    if (err) {\n                      emitEnd(err);\n                    } else {\n                      emitEnd(null, stdoutRing.get(), stderrRing.get());\n                    }\n                  }\n                );\n              });\n            } else {\n              emitEnd(null, stdoutRing.get(), stderrRing.get());\n            }\n          }\n        }\n      );\n    });\n\n    return this;\n  };\n\n\n  /**\n   * Renice current and/or future ffmpeg processes\n   *\n   * Ignored on Windows platforms.\n   *\n   * @method FfmpegCommand#renice\n   * @category Processing\n   *\n   * @param {Number} [niceness=0] niceness value between -20 (highest priority) and 20 (lowest priority)\n   * @return FfmpegCommand\n   */\n  proto.renice = function(niceness) {\n    if (!utils.isWindows) {\n      niceness = niceness || 0;\n\n      if (niceness < -20 || niceness > 20) {\n        this.logger.warn('Invalid niceness value: ' + niceness + ', must be between -20 and 20');\n      }\n\n      niceness = Math.min(20, Math.max(-20, niceness));\n      this.options.niceness = niceness;\n\n      if (this.ffmpegProc) {\n        var logger = this.logger;\n        var pid = this.ffmpegProc.pid;\n        var renice = spawn('renice', [niceness, '-p', pid], {windowsHide: true});\n\n        renice.on('error', function(err) {\n          logger.warn('could not renice process ' + pid + ': ' + err.message);\n        });\n\n        renice.on('exit', function(code, signal) {\n          if (signal) {\n            logger.warn('could not renice process ' + pid + ': renice was killed by signal ' + signal);\n          } else if (code) {\n            logger.warn('could not renice process ' + pid + ': renice exited with ' + code);\n          } else {\n            logger.info('successfully reniced process ' + pid + ' to ' + niceness + ' niceness');\n          }\n        });\n      }\n    }\n\n    return this;\n  };\n\n\n  /**\n   * Kill current ffmpeg process, if any\n   *\n   * @method FfmpegCommand#kill\n   * @category Processing\n   *\n   * @param {String} [signal=SIGKILL] signal name\n   * @return FfmpegCommand\n   */\n  proto.kill = function(signal) {\n    if (!this.ffmpegProc) {\n      this.logger.warn('No running ffmpeg process, cannot send signal');\n    } else {\n      this.ffmpegProc.kill(signal || 'SIGKILL');\n    }\n\n    return this;\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar utils = require('../utils');\n\n/*\n *! Input-related methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Add an input to command\n   *\n   * Also switches \"current input\", that is the input that will be affected\n   * by subsequent input-related methods.\n   *\n   * Note: only one stream input is supported for now.\n   *\n   * @method FfmpegCommand#input\n   * @category Input\n   * @aliases mergeAdd,addInput\n   *\n   * @param {String|Readable} source input file path or readable stream\n   * @return FfmpegCommand\n   */\n  proto.mergeAdd =\n  proto.addInput =\n  proto.input = function(source) {\n    var isFile = false;\n    var isStream = false;\n\n    if (typeof source !== 'string') {\n      if (!('readable' in source) || !(source.readable)) {\n        throw new Error('Invalid input');\n      }\n\n      var hasInputStream = this._inputs.some(function(input) {\n        return input.isStream;\n      });\n\n      if (hasInputStream) {\n        throw new Error('Only one input stream is supported');\n      }\n\n      isStream = true;\n      source.pause();\n    } else {\n      var protocol = source.match(/^([a-z]{2,}):/i);\n      isFile = !protocol || protocol[0] === 'file';\n    }\n\n    this._inputs.push(this._currentInput = {\n      source: source,\n      isFile: isFile,\n      isStream: isStream,\n      options: utils.args()\n    });\n\n    return this;\n  };\n\n\n  /**\n   * Specify input format for the last specified input\n   *\n   * @method FfmpegCommand#inputFormat\n   * @category Input\n   * @aliases withInputFormat,fromFormat\n   *\n   * @param {String} format input format\n   * @return FfmpegCommand\n   */\n  proto.withInputFormat =\n  proto.inputFormat =\n  proto.fromFormat = function(format) {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    this._currentInput.options('-f', format);\n    return this;\n  };\n\n\n  /**\n   * Specify input FPS for the last specified input\n   * (only valid for raw video formats)\n   *\n   * @method FfmpegCommand#inputFps\n   * @category Input\n   * @aliases withInputFps,withInputFPS,withFpsInput,withFPSInput,inputFPS,inputFps,fpsInput\n   *\n   * @param {Number} fps input FPS\n   * @return FfmpegCommand\n   */\n  proto.withInputFps =\n  proto.withInputFPS =\n  proto.withFpsInput =\n  proto.withFPSInput =\n  proto.inputFPS =\n  proto.inputFps =\n  proto.fpsInput =\n  proto.FPSInput = function(fps) {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    this._currentInput.options('-r', fps);\n    return this;\n  };\n\n\n  /**\n   * Use native framerate for the last specified input\n   *\n   * @method FfmpegCommand#native\n   * @category Input\n   * @aliases nativeFramerate,withNativeFramerate\n   *\n   * @return FfmmegCommand\n   */\n  proto.nativeFramerate =\n  proto.withNativeFramerate =\n  proto.native = function() {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    this._currentInput.options('-re');\n    return this;\n  };\n\n\n  /**\n   * Specify input seek time for the last specified input\n   *\n   * @method FfmpegCommand#seekInput\n   * @category Input\n   * @aliases setStartTime,seekTo\n   *\n   * @param {String|Number} seek seek time in seconds or as a '[hh:[mm:]]ss[.xxx]' string\n   * @return FfmpegCommand\n   */\n  proto.setStartTime =\n  proto.seekInput = function(seek) {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    this._currentInput.options('-ss', seek);\n\n    return this;\n  };\n\n\n  /**\n   * Loop over the last specified input\n   *\n   * @method FfmpegCommand#loop\n   * @category Input\n   *\n   * @param {String|Number} [duration] loop duration in seconds or as a '[[hh:]mm:]ss[.xxx]' string\n   * @return FfmpegCommand\n   */\n  proto.loop = function(duration) {\n    if (!this._currentInput) {\n      throw new Error('No input specified');\n    }\n\n    this._currentInput.options('-loop', '1');\n\n    if (typeof duration !== 'undefined') {\n      this.duration(duration);\n    }\n\n    return this;\n  };\n};\n","module.exports = require(\"node:path\");",null,"var fs = require('fs')\nvar core\nif (process.platform === 'win32' || global.TESTING_WINDOWS) {\n  core = require('./windows.js')\n} else {\n  core = require('./mode.js')\n}\n\nmodule.exports = isexe\nisexe.sync = sync\n\nfunction isexe (path, options, cb) {\n  if (typeof options === 'function') {\n    cb = options\n    options = {}\n  }\n\n  if (!cb) {\n    if (typeof Promise !== 'function') {\n      throw new TypeError('callback not provided')\n    }\n\n    return new Promise(function (resolve, reject) {\n      isexe(path, options || {}, function (er, is) {\n        if (er) {\n          reject(er)\n        } else {\n          resolve(is)\n        }\n      })\n    })\n  }\n\n  core(path, options || {}, function (er, is) {\n    // ignore EACCES because that just means we aren't allowed to run it\n    if (er) {\n      if (er.code === 'EACCES' || options && options.ignoreErrors) {\n        er = null\n        is = false\n      }\n    }\n    cb(er, is)\n  })\n}\n\nfunction sync (path, options) {\n  // my kingdom for a filtered catch\n  try {\n    return core.sync(path, options || {})\n  } catch (er) {\n    if (options && options.ignoreErrors || er.code === 'EACCES') {\n      return false\n    } else {\n      throw er\n    }\n  }\n}\n","module.exports = isexe\nisexe.sync = sync\n\nvar fs = require('fs')\n\nfunction checkPathExt (path, options) {\n  var pathext = options.pathExt !== undefined ?\n    options.pathExt : process.env.PATHEXT\n\n  if (!pathext) {\n    return true\n  }\n\n  pathext = pathext.split(';')\n  if (pathext.indexOf('') !== -1) {\n    return true\n  }\n  for (var i = 0; i < pathext.length; i++) {\n    var p = pathext[i].toLowerCase()\n    if (p && path.substr(-p.length).toLowerCase() === p) {\n      return true\n    }\n  }\n  return false\n}\n\nfunction checkStat (stat, path, options) {\n  if (!stat.isSymbolicLink() && !stat.isFile()) {\n    return false\n  }\n  return checkPathExt(path, options)\n}\n\nfunction isexe (path, options, cb) {\n  fs.stat(path, function (er, stat) {\n    cb(er, er ? false : checkStat(stat, path, options))\n  })\n}\n\nfunction sync (path, options) {\n  return checkStat(fs.statSync(path), path, options)\n}\n","module.exports = require(\"os\");","module.exports = require(\"fs\");","module.exports = require(\"path\");","/*jshint node:true*/\n'use strict';\n\nvar fs = require('fs');\nvar path = require('path');\nvar PassThrough = require('stream').PassThrough;\nvar async = require('async');\nvar utils = require('./utils');\n\n\n/*\n * Useful recipes for commands\n */\n\nmodule.exports = function recipes(proto) {\n  /**\n   * Execute ffmpeg command and save output to a file\n   *\n   * @method FfmpegCommand#save\n   * @category Processing\n   * @aliases saveToFile\n   *\n   * @param {String} output file path\n   * @return FfmpegCommand\n   */\n  proto.saveToFile =\n  proto.save = function(output) {\n    this.output(output).run();\n    return this;\n  };\n\n\n  /**\n   * Execute ffmpeg command and save output to a stream\n   *\n   * If 'stream' is not specified, a PassThrough stream is created and returned.\n   * 'options' will be used when piping ffmpeg output to the output stream\n   * (@see http://nodejs.org/api/stream.html#stream_readable_pipe_destination_options)\n   *\n   * @method FfmpegCommand#pipe\n   * @category Processing\n   * @aliases stream,writeToStream\n   *\n   * @param {stream.Writable} [stream] output stream\n   * @param {Object} [options={}] pipe options\n   * @return Output stream\n   */\n  proto.writeToStream =\n  proto.pipe =\n  proto.stream = function(stream, options) {\n    if (stream && !('writable' in stream)) {\n      options = stream;\n      stream = undefined;\n    }\n\n    if (!stream) {\n      if (process.version.match(/v0\\.8\\./)) {\n        throw new Error('PassThrough stream is not supported on node v0.8');\n      }\n\n      stream = new PassThrough();\n    }\n\n    this.output(stream, options).run();\n    return stream;\n  };\n\n\n  /**\n   * Generate images from a video\n   *\n   * Note: this method makes the command emit a 'filenames' event with an array of\n   * the generated image filenames.\n   *\n   * @method FfmpegCommand#screenshots\n   * @category Processing\n   * @aliases takeScreenshots,thumbnail,thumbnails,screenshot\n   *\n   * @param {Number|Object} [config=1] screenshot count or configuration object with\n   *   the following keys:\n   * @param {Number} [config.count] number of screenshots to take; using this option\n   *   takes screenshots at regular intervals (eg. count=4 would take screens at 20%, 40%,\n   *   60% and 80% of the video length).\n   * @param {String} [config.folder='.'] output folder\n   * @param {String} [config.filename='tn.png'] output filename pattern, may contain the following\n   *   tokens:\n   *   - '%s': offset in seconds\n   *   - '%w': screenshot width\n   *   - '%h': screenshot height\n   *   - '%r': screenshot resolution (same as '%wx%h')\n   *   - '%f': input filename\n   *   - '%b': input basename (filename w/o extension)\n   *   - '%i': index of screenshot in timemark array (can be zero-padded by using it like `%000i`)\n   * @param {Number[]|String[]} [config.timemarks] array of timemarks to take screenshots\n   *   at; each timemark may be a number of seconds, a '[[hh:]mm:]ss[.xxx]' string or a\n   *   'XX%' string.  Overrides 'count' if present.\n   * @param {Number[]|String[]} [config.timestamps] alias for 'timemarks'\n   * @param {Boolean} [config.fastSeek] use fast seek (less accurate)\n   * @param {String} [config.size] screenshot size, with the same syntax as {@link FfmpegCommand#size}\n   * @param {String} [folder] output folder (legacy alias for 'config.folder')\n   * @return FfmpegCommand\n   */\n  proto.takeScreenshots =\n  proto.thumbnail =\n  proto.thumbnails =\n  proto.screenshot =\n  proto.screenshots = function(config, folder) {\n    var self = this;\n    var source = this._currentInput.source;\n    config = config || { count: 1 };\n\n    // Accept a number of screenshots instead of a config object\n    if (typeof config === 'number') {\n      config = {\n        count: config\n      };\n    }\n\n    // Accept a second 'folder' parameter instead of config.folder\n    if (!('folder' in config)) {\n      config.folder = folder || '.';\n    }\n\n    // Accept 'timestamps' instead of 'timemarks'\n    if ('timestamps' in config) {\n      config.timemarks = config.timestamps;\n    }\n\n    // Compute timemarks from count if not present\n    if (!('timemarks' in config)) {\n      if (!config.count) {\n        throw new Error('Cannot take screenshots: neither a count nor a timemark list are specified');\n      }\n\n      var interval = 100 / (1 + config.count);\n      config.timemarks = [];\n      for (var i = 0; i < config.count; i++) {\n        config.timemarks.push((interval * (i + 1)) + '%');\n      }\n    }\n\n    // Parse size option\n    if ('size' in config) {\n      var fixedSize = config.size.match(/^(\\d+)x(\\d+)$/);\n      var fixedWidth = config.size.match(/^(\\d+)x\\?$/);\n      var fixedHeight = config.size.match(/^\\?x(\\d+)$/);\n      var percentSize = config.size.match(/^(\\d+)%$/);\n\n      if (!fixedSize && !fixedWidth && !fixedHeight && !percentSize) {\n        throw new Error('Invalid size parameter: ' + config.size);\n      }\n    }\n\n    // Metadata helper\n    var metadata;\n    function getMetadata(cb) {\n      if (metadata) {\n        cb(null, metadata);\n      } else {\n        self.ffprobe(function(err, meta) {\n          metadata = meta;\n          cb(err, meta);\n        });\n      }\n    }\n\n    async.waterfall([\n      // Compute percent timemarks if any\n      function computeTimemarks(next) {\n        if (config.timemarks.some(function(t) { return ('' + t).match(/^[\\d.]+%$/); })) {\n          if (typeof source !== 'string') {\n            return next(new Error('Cannot compute screenshot timemarks with an input stream, please specify fixed timemarks'));\n          }\n\n          getMetadata(function(err, meta) {\n            if (err) {\n              next(err);\n            } else {\n              // Select video stream with the highest resolution\n              var vstream = meta.streams.reduce(function(biggest, stream) {\n                if (stream.codec_type === 'video' && stream.width * stream.height > biggest.width * biggest.height) {\n                  return stream;\n                } else {\n                  return biggest;\n                }\n              }, { width: 0, height: 0 });\n\n              if (vstream.width === 0) {\n                return next(new Error('No video stream in input, cannot take screenshots'));\n              }\n\n              var duration = Number(vstream.duration);\n              if (isNaN(duration)) {\n                duration = Number(meta.format.duration);\n              }\n\n              if (isNaN(duration)) {\n                return next(new Error('Could not get input duration, please specify fixed timemarks'));\n              }\n\n              config.timemarks = config.timemarks.map(function(mark) {\n                if (('' + mark).match(/^([\\d.]+)%$/)) {\n                  return duration * parseFloat(mark) / 100;\n                } else {\n                  return mark;\n                }\n              });\n\n              next();\n            }\n          });\n        } else {\n          next();\n        }\n      },\n\n      // Turn all timemarks into numbers and sort them\n      function normalizeTimemarks(next) {\n        config.timemarks = config.timemarks.map(function(mark) {\n          return utils.timemarkToSeconds(mark);\n        }).sort(function(a, b) { return a - b; });\n\n        next();\n      },\n\n      // Add '_%i' to pattern when requesting multiple screenshots and no variable token is present\n      function fixPattern(next) {\n        var pattern = config.filename || 'tn.png';\n\n        if (pattern.indexOf('.') === -1) {\n          pattern += '.png';\n        }\n\n        if (config.timemarks.length > 1 && !pattern.match(/%(s|0*i)/)) {\n          var ext = path.extname(pattern);\n          pattern = path.join(path.dirname(pattern), path.basename(pattern, ext) + '_%i' + ext);\n        }\n\n        next(null, pattern);\n      },\n\n      // Replace filename tokens (%f, %b) in pattern\n      function replaceFilenameTokens(pattern, next) {\n        if (pattern.match(/%[bf]/)) {\n          if (typeof source !== 'string') {\n            return next(new Error('Cannot replace %f or %b when using an input stream'));\n          }\n\n          pattern = pattern\n            .replace(/%f/g, path.basename(source))\n            .replace(/%b/g, path.basename(source, path.extname(source)));\n        }\n\n        next(null, pattern);\n      },\n\n      // Compute size if needed\n      function getSize(pattern, next) {\n        if (pattern.match(/%[whr]/)) {\n          if (fixedSize) {\n            return next(null, pattern, fixedSize[1], fixedSize[2]);\n          }\n\n          getMetadata(function(err, meta) {\n            if (err) {\n              return next(new Error('Could not determine video resolution to replace %w, %h or %r'));\n            }\n\n            var vstream = meta.streams.reduce(function(biggest, stream) {\n              if (stream.codec_type === 'video' && stream.width * stream.height > biggest.width * biggest.height) {\n                return stream;\n              } else {\n                return biggest;\n              }\n            }, { width: 0, height: 0 });\n\n            if (vstream.width === 0) {\n              return next(new Error('No video stream in input, cannot replace %w, %h or %r'));\n            }\n\n            var width = vstream.width;\n            var height = vstream.height;\n\n            if (fixedWidth) {\n              height = height * Number(fixedWidth[1]) / width;\n              width = Number(fixedWidth[1]);\n            } else if (fixedHeight) {\n              width = width * Number(fixedHeight[1]) / height;\n              height = Number(fixedHeight[1]);\n            } else if (percentSize) {\n              width = width * Number(percentSize[1]) / 100;\n              height = height * Number(percentSize[1]) / 100;\n            }\n\n            next(null, pattern, Math.round(width / 2) * 2, Math.round(height / 2) * 2);\n          });\n        } else {\n          next(null, pattern, -1, -1);\n        }\n      },\n\n      // Replace size tokens (%w, %h, %r) in pattern\n      function replaceSizeTokens(pattern, width, height, next) {\n        pattern = pattern\n          .replace(/%r/g, '%wx%h')\n          .replace(/%w/g, width)\n          .replace(/%h/g, height);\n\n        next(null, pattern);\n      },\n\n      // Replace variable tokens in pattern (%s, %i) and generate filename list\n      function replaceVariableTokens(pattern, next) {\n        var filenames = config.timemarks.map(function(t, i) {\n          return pattern\n            .replace(/%s/g, utils.timemarkToSeconds(t))\n            .replace(/%(0*)i/g, function(match, padding) {\n              var idx = '' + (i + 1);\n              return padding.substr(0, Math.max(0, padding.length + 1 - idx.length)) + idx;\n            });\n        });\n\n        self.emit('filenames', filenames);\n        next(null, filenames);\n      },\n\n      // Create output directory\n      function createDirectory(filenames, next) {\n        fs.exists(config.folder, function(exists) {\n          if (!exists) {\n            fs.mkdir(config.folder, function(err) {\n              if (err) {\n                next(err);\n              } else {\n                next(null, filenames);\n              }\n            });\n          } else {\n            next(null, filenames);\n          }\n        });\n      }\n    ], function runCommand(err, filenames) {\n      if (err) {\n        return self.emit('error', err);\n      }\n\n      var count = config.timemarks.length;\n      var split;\n      var filters = [split = {\n        filter: 'split',\n        options: count,\n        outputs: []\n      }];\n\n      if ('size' in config) {\n        // Set size to generate size filters\n        self.size(config.size);\n\n        // Get size filters and chain them with 'sizeN' stream names\n        var sizeFilters =  self._currentOutput.sizeFilters.get().map(function(f, i) {\n          if (i > 0) {\n            f.inputs = 'size' + (i - 1);\n          }\n\n          f.outputs = 'size' + i;\n\n          return f;\n        });\n\n        // Input last size filter output into split filter\n        split.inputs = 'size' + (sizeFilters.length - 1);\n\n        // Add size filters in front of split filter\n        filters = sizeFilters.concat(filters);\n\n        // Remove size filters\n        self._currentOutput.sizeFilters.clear();\n      }\n\n      var first = 0;\n      for (var i = 0; i < count; i++) {\n        var stream = 'screen' + i;\n        split.outputs.push(stream);\n\n        if (i === 0) {\n          first = config.timemarks[i];\n          self.seekInput(first);\n        }\n\n        self.output(path.join(config.folder, filenames[i]))\n          .frames(1)\n          .map(stream);\n\n        if (i > 0) {\n          self.seek(config.timemarks[i] - first);\n        }\n      }\n\n      self.complexFilter(filters);\n      self.run();\n    });\n\n    return this;\n  };\n\n\n  /**\n   * Merge (concatenate) inputs to a single file\n   *\n   * @method FfmpegCommand#concat\n   * @category Processing\n   * @aliases concatenate,mergeToFile\n   *\n   * @param {String|Writable} target output file or writable stream\n   * @param {Object} [options] pipe options (only used when outputting to a writable stream)\n   * @return FfmpegCommand\n   */\n  proto.mergeToFile =\n  proto.concatenate =\n  proto.concat = function(target, options) {\n    // Find out which streams are present in the first non-stream input\n    var fileInput = this._inputs.filter(function(input) {\n      return !input.isStream;\n    })[0];\n\n    var self = this;\n    this.ffprobe(this._inputs.indexOf(fileInput), function(err, data) {\n      if (err) {\n        return self.emit('error', err);\n      }\n\n      var hasAudioStreams = data.streams.some(function(stream) {\n        return stream.codec_type === 'audio';\n      });\n\n      var hasVideoStreams = data.streams.some(function(stream) {\n        return stream.codec_type === 'video';\n      });\n\n      // Setup concat filter and start processing\n      self.output(target, options)\n        .complexFilter({\n          filter: 'concat',\n          options: {\n            n: self._inputs.length,\n            v: hasVideoStreams ? 1 : 0,\n            a: hasAudioStreams ? 1 : 0\n          }\n        })\n        .run();\n    });\n\n    return this;\n  };\n};\n","/*jshint node:true*/\n'use strict';\n\nvar utils = require('../utils');\n\n\n/*\n *! Audio-related methods\n */\n\nmodule.exports = function(proto) {\n  /**\n   * Disable audio in the output\n   *\n   * @method FfmpegCommand#noAudio\n   * @category Audio\n   * @aliases withNoAudio\n   * @return FfmpegCommand\n   */\n  proto.withNoAudio =\n  proto.noAudio = function() {\n    this._currentOutput.audio.clear();\n    this._currentOutput.audioFilters.clear();\n    this._currentOutput.audio('-an');\n\n    return this;\n  };\n\n\n  /**\n   * Specify audio codec\n   *\n   * @method FfmpegCommand#audioCodec\n   * @category Audio\n   * @aliases withAudioCodec\n   *\n   * @param {String} codec audio codec name\n   * @return FfmpegCommand\n   */\n  proto.withAudioCodec =\n  proto.audioCodec = function(codec) {\n    this._currentOutput.audio('-acodec', codec);\n\n    return this;\n  };\n\n\n  /**\n   * Specify audio bitrate\n   *\n   * @method FfmpegCommand#audioBitrate\n   * @category Audio\n   * @aliases withAudioBitrate\n   *\n   * @param {String|Number} bitrate audio bitrate in kbps (with an optional 'k' suffix)\n   * @return FfmpegCommand\n   */\n  proto.withAudioBitrate =\n  proto.audioBitrate = function(bitrate) {\n    this._currentOutput.audio('-b:a', ('' + bitrate).replace(/k?$/, 'k'));\n    return this;\n  };\n\n\n  /**\n   * Specify audio channel count\n   *\n   * @method FfmpegCommand#audioChannels\n   * @category Audio\n   * @aliases withAudioChannels\n   *\n   * @param {Number} channels channel count\n   * @return FfmpegCommand\n   */\n  proto.withAudioChannels =\n  proto.audioChannels = function(channels) {\n    this._currentOutput.audio('-ac', channels);\n    return this;\n  };\n\n\n  /**\n   * Specify audio frequency\n   *\n   * @method FfmpegCommand#audioFrequency\n   * @category Audio\n   * @aliases withAudioFrequency\n   *\n   * @param {Number} freq audio frequency in Hz\n   * @return FfmpegCommand\n   */\n  proto.withAudioFrequency =\n  proto.audioFrequency = function(freq) {\n    this._currentOutput.audio('-ar', freq);\n    return this;\n  };\n\n\n  /**\n   * Specify audio quality\n   *\n   * @method FfmpegCommand#audioQuality\n   * @category Audio\n   * @aliases withAudioQuality\n   *\n   * @param {Number} quality audio quality factor\n   * @return FfmpegCommand\n   */\n  proto.withAudioQuality =\n  proto.audioQuality = function(quality) {\n    this._currentOutput.audio('-aq', quality);\n    return this;\n  };\n\n\n  /**\n   * Specify custom audio filter(s)\n   *\n   * Can be called both with one or many filters, or a filter array.\n   *\n   * @example\n   * command.audioFilters('filter1');\n   *\n   * @example\n   * command.audioFilters('filter1', 'filter2=param1=value1:param2=value2');\n   *\n   * @example\n   * command.audioFilters(['filter1', 'filter2']);\n   *\n   * @example\n   * command.audioFilters([\n   *   {\n   *     filter: 'filter1'\n   *   },\n   *   {\n   *     filter: 'filter2',\n   *     options: 'param=value:param=value'\n   *   }\n   * ]);\n   *\n   * @example\n   * command.audioFilters(\n   *   {\n   *     filter: 'filter1',\n   *     options: ['value1', 'value2']\n   *   },\n   *   {\n   *     filter: 'filter2',\n   *     options: { param1: 'value1', param2: 'value2' }\n   *   }\n   * );\n   *\n   * @method FfmpegCommand#audioFilters\n   * @aliases withAudioFilter,withAudioFilters,audioFilter\n   * @category Audio\n   *\n   * @param {...String|String[]|Object[]} filters audio filter strings, string array or\n   *   filter specification array, each with the following properties:\n   * @param {String} filters.filter filter name\n   * @param {String|String[]|Object} [filters.options] filter option string, array, or object\n   * @return FfmpegCommand\n   */\n  proto.withAudioFilter =\n  proto.withAudioFilters =\n  proto.audioFilter =\n  proto.audioFilters = function(filters) {\n    if (arguments.length > 1) {\n      filters = [].slice.call(arguments);\n    }\n\n    if (!Array.isArray(filters)) {\n      filters = [filters];\n    }\n\n    this._currentOutput.audioFilters(utils.makeFilterStrings(filters));\n    return this;\n  };\n};\n","var path = require('path');\nvar spawn = require('child_process').spawn;\nvar debug = require('debug')('electron-squirrel-startup');\nvar app = require('electron').app;\n\nvar run = function(args, done) {\n  var updateExe = path.resolve(path.dirname(process.execPath), '..', 'Update.exe');\n  debug('Spawning `%s` with args `%s`', updateExe, args);\n  spawn(updateExe, args, {\n    detached: true\n  }).on('close', done);\n};\n\nvar check = function() {\n  if (process.platform === 'win32') {\n    var cmd = process.argv[1];\n    debug('processing squirrel command `%s`', cmd);\n    var target = path.basename(process.execPath);\n\n    if (cmd === '--squirrel-install' || cmd === '--squirrel-updated') {\n      run(['--createShortcut=' + target + ''], app.quit);\n      return true;\n    }\n    if (cmd === '--squirrel-uninstall') {\n      run(['--removeShortcut=' + target + ''], app.quit);\n      return true;\n    }\n    if (cmd === '--squirrel-obsolete') {\n      app.quit();\n      return true;\n    }\n  }\n  return false;\n};\n\nmodule.exports = check();\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","\nif (typeof __webpack_require__ !== 'undefined') __webpack_require__.ab = __dirname + \"/native_modules/\";","const { app, BrowserWindow, ipcMain } = require('electron');\nconst path = require('node:path');\n\n// Handle creating/removing shortcuts on Windows when installing/uninstalling.\nif (require('electron-squirrel-startup')) {\n  app.quit();\n}\n\nlet mainWindow;\n\nconst createWindow = () => {\n  // Create the browser window.\n  mainWindow = new BrowserWindow({\n    width: 1400,\n    height: 900,\n    minWidth: 1000,\n    minHeight: 600,\n    webPreferences: {\n      preload: MAIN_WINDOW_PRELOAD_WEBPACK_ENTRY,\n      contextIsolation: true,\n      nodeIntegration: false\n    },\n  });\n\n  // and load the index.html of the app.\n  mainWindow.loadURL(MAIN_WINDOW_WEBPACK_ENTRY);\n\n  // Open the DevTools.\n  mainWindow.webContents.openDevTools();\n\n  mainWindow.on('closed', () => {\n    mainWindow = null;\n  });\n};\n\n// Register IPC handlers\nipcMain.handle('read-metadata', async (event, filePath) => {\n  throw new Error('Not implemented - will be added in PR-2');\n});\n\nipcMain.handle('select-file', async () => {\n  throw new Error('Not implemented - will be added in PR-2');\n});\n\nipcMain.handle('export-timeline', async (event, data) => {\n  throw new Error('Not implemented - will be added in PR-5');\n});\n\nipcMain.handle('select-save-location', async () => {\n  throw new Error('Not implemented - will be added in PR-5');\n});\n\n// This method will be called when Electron has finished\n// initialization and is ready to create browser windows.\n// Some APIs can only be used after this event occurs.\napp.whenReady().then(() => {\n  // Test FFmpeg availability\n  try {\n    const ffmpeg = require('fluent-ffmpeg');\n    const { getFFmpegPath, getFFprobePath } = require('../electron/utils/ffmpegPath');\n    \n    ffmpeg.setFfmpegPath(getFFmpegPath());\n    ffmpeg.setFfprobePath(getFFprobePath());\n    \n    console.log('FFmpeg path:', getFFmpegPath());\n    console.log('FFprobe path:', getFFprobePath());\n    \n    // Quick test\n    ffmpeg.getAvailableFormats((err, formats) => {\n      if (err) {\n        console.error('FFmpeg not available:', err);\n      } else {\n        console.log('FFmpeg is working! Formats available:', Object.keys(formats).length);\n      }\n    });\n  } catch (err) {\n    console.error('FFmpeg setup failed:', err);\n  }\n\n  createWindow();\n\n  // On OS X it's common to re-create a window in the app when the\n  // dock icon is clicked and there are no other windows open.\n  app.on('activate', () => {\n    if (BrowserWindow.getAllWindows().length === 0) {\n      createWindow();\n    }\n  });\n});\n\n// Quit when all windows are closed, except on macOS. There, it's common\n// for applications and their menu bar to stay active until the user quits\n// explicitly with Cmd + Q.\napp.on('window-all-closed', () => {\n  if (process.platform !== 'darwin') {\n    app.quit();\n  }\n});\n\n// In this file you can include the rest of your app's specific main process\n// code. You can also put them in separate files and import them here.\n"],"names":["utils","module","exports","proto","addOutput","output","target","pipeopts","isFile","this","_currentOutput","Error","protocol","match","_outputs","some","push","flags","self","forEach","key","args","seekOutput","seek","options","withDuration","setDuration","duration","toFormat","withOutputFormat","outputFormat","format","map","spec","replace","streamRegexp","updateFlvMetadata","flvmeta","require","process","type","addInputOption","addInputOptions","withInputOption","withInputOptions","inputOption","inputOptions","_currentInput","doSplit","arguments","length","slice","call","Array","isArray","reduce","option","split","String","addOutputOption","addOutputOptions","addOption","addOptions","withOutputOption","withOutputOptions","withOption","withOptions","outputOption","outputOptions","filterGraph","complexFilter","_complexFilters","clear","makeFilterStrings","join","streamSpec","path","app","os","getFFmpegPath","arch","platform","resourcesPath","getFFprobePath","getScalePadFilters","width","height","aspect","color","filter","w","h","x","y","createSizeFilters","value","data","sizeData","fixedSize","size","fixedWidth","fixedHeight","percentRatio","ratio","Number","Math","round","pad","keepPixelAspect","keepDisplayAspect","keepDisplayAspectRatio","keepDAR","videoFilters","withSize","setSize","filters","sizeFilters","withAspect","withAspectRatio","setAspect","setAspectRatio","aspectRatio","a","isNaN","applyAutopadding","applyAutoPadding","applyAutopad","applyAutoPad","withAutopadding","withAutoPadding","withAutopad","withAutoPad","autoPad","autopad","tty","util","init","debug","inspectOpts","keys","Object","i","log","stream","write","apply","formatArgs","name","namespace","useColors","c","prefix","humanize","diff","Date","toUTCString","save","namespaces","env","DEBUG","load","Boolean","colors","isatty","fd","test","obj","prop","substring","toLowerCase","_","k","toUpperCase","val","parseInt","DEBUG_FD","deprecate","stdout","stderr","binding","guessHandleType","WriteStream","_type","_handle","unref","SyncWriteStream","autoClose","Socket","readable","writable","read","_isStdio","createWritableStdioStream","formatters","o","v","inspect","str","trim","O","enable","r","storage","e","console","Function","prototype","splice","index","lastC","removeItem","window","document","documentElement","style","WebkitAppearance","firebug","exception","table","navigator","userAgent","RegExp","$1","chrome","local","localStorage","localstorage","j","JSON","stringify","err","message","s","m","d","plural","ms","n","floor","ceil","exec","parseFloat","parse","long","fmtShort","prevTime","createDebug","enabled","curr","prev","coerce","unshift","formatter","bind","hash","charCodeAt","abs","selectColor","stack","disable","names","skips","len","substr","root","previous_async","async","only_once","fn","called","noConflict","_each","arr","iterator","_map","results","_keys","hasOwnProperty","nextTick","setImmediate","setTimeout","each","callback","completed","eachSeries","iterate","forEachSeries","eachLimit","limit","_eachLimit","forEachLimit","started","running","replenish","doParallel","concat","doSeries","_asyncMap","eachfn","mapSeries","mapLimit","_mapLimit","doParallelLimit","memo","inject","foldl","reduceRight","reversed","reverse","foldr","_filter","sort","b","filterSeries","select","selectSeries","_reject","reject","rejectSeries","_detect","main_callback","result","detect","detectSeries","any","every","all","sortBy","criteria","left","right","auto","tasks","listeners","addListener","taskComplete","task","taskCallback","safeResults","rkey","requires","ready","listener","removeListener","waterfall","constructor","wrapIterator","next","_parallel","parallel","parallelLimit","series","makeCallback","_concat","cb","concatSeries","whilst","doWhilst","until","doUntil","queue","worker","concurrency","_insert","q","pos","item","saturated","undefined","workers","empty","drain","shift","cargo","payload","working","ts","ds","_console_fn","error","dir","memoize","hasher","queues","memoized","pop","l","unmemoized","unmemoize","times","count","counter","timesSeries","compose","fns","that","newargs","nextargs","_applyEach","go","applyEach","applyEachSeries","forever","define","amd","isexe","sync","checkStat","fs","statSync","stat","er","mod","mode","uid","gid","myUid","getuid","myGid","getgid","u","g","checkMode","withNoVideo","noVideo","video","withVideoCodec","videoCodec","codec","withVideoBitrate","videoBitrate","bitrate","constant","withVideoFilter","withVideoFilters","videoFilter","withOutputFps","withOutputFPS","withFpsOutput","withFPSOutput","withFps","withFPS","outputFPS","outputFps","fpsOutput","FPSOutput","fps","FPS","takeFrames","withFrames","frames","which","cmd","opt","info","getPathInfo","pathEnv","pathExt","ext","pathExtExe","extExe","found","pathPart","charAt","p","ll","cur","ex","nothrow","getNotFoundError","isWindows","OSTYPE","COLON","code","colon","PATH","cwd","PATHEXT","indexOf","F","E","ii","is","spawn","legacyTag","legacyDisposition","ffprobe","input","ended","handleCallback","_inputs","_getFfprobePath","stdoutClosed","stderrClosed","src","isStream","source","windowsHide","stdin","on","pause","unpipe","pipe","exitError","handleExit","processExited","out","lines","line","streams","chapters","parseBlock","kv","chapter","parseFfprobeOutput","legacyTagKeys","tags","tagKey","legacyDispositionKeys","disposition","dispositionKey","signal","avCodecRegexp","ffCodecRegexp","ffEncodersRegexp","ffDecodersRegexp","encodersRegexp","formatRegexp","lineBreakRegexp","filterRegexp","cache","setFfmpegPath","ffmpegPath","setFfprobePath","ffprobePath","setFlvtoolPath","flvtool","flvtoolPath","_forgetPaths","_getFfmpegPath","FFMPEG_PATH","exists","ffmpeg","FFPROBE_PATH","dirname","_getFlvtoolPath","FLVMETA_PATH","FLVTOOL2_PATH","flvtool2","availableFilters","getAvailableFilters","_spawnFfmpeg","captureStdout","stdoutLines","stdoutRing","get","types","A","V","description","multipleInputs","multipleOutputs","availableCodecs","getAvailableCodecs","codecs","canDecode","canEncode","drawHorizBand","directRendering","weirdFrameTruncation","codecData","intraFrameOnly","isLossy","isLossless","encoders","decoders","coderData","copy","availableEncoders","getAvailableEncoders","frameMT","sliceMT","experimental","availableFormats","getAvailableFormats","formats","canDemux","canMux","_checkCapabilities","unavailable","fmts","find","cdcs","acodec","audio","vcodec","nlRegexp","filterEscapeRegexp","whichCache","dest","list","argfunc","arg","remove","clone","cloned","filterSpec","filterString","inputs","outputs","timemarkToSeconds","timemark","parts","secs","extractCodecData","command","stderrLine","codecsObject","inputStack","inputIndex","inInput","dur","audio_details","video_details","emit","extractProgress","progress","progressParts","progressSplit","parseProgressLine","ret","frame","currentFps","currentKbps","targetSize","Lsize","time","_ffprobeData","percent","extractError","messages","linesRing","maxLines","cbs","current","closed","max","append","Buffer","newLines","close","runFfprobe","processCB","endCB","niceness","stderrRing","ffmpegProc","setEncoding","_getArguments","complexFilters","fileOutput","_global","outputArg","audioFilters","_prepare","readMetadata","logger","warn","once","event","execute","run","outputStream","inputStream","emitEnd","reportingErr","inputStreamError","kill","resume","timeout","processTimer","msg","outputStreamError","codecDataSent","codecObject","clearTimeout","renice","min","pid","mergeAdd","addInput","withInputFormat","inputFormat","fromFormat","withInputFps","withInputFPS","withFpsInput","withFPSInput","inputFPS","inputFps","fpsInput","FPSInput","nativeFramerate","withNativeFramerate","native","setStartTime","seekInput","loop","core","Promise","TypeError","resolve","ignoreErrors","global","TESTING_WINDOWS","isSymbolicLink","pathext","checkPathExt","PassThrough","saveToFile","writeToStream","version","takeScreenshots","thumbnail","thumbnails","screenshot","screenshots","config","folder","metadata","timemarks","timestamps","interval","percentSize","getMetadata","meta","t","vstream","biggest","codec_type","mark","pattern","filename","extname","basename","filenames","padding","idx","mkdir","f","first","mergeToFile","concatenate","fileInput","hasAudioStreams","hasVideoStreams","withNoAudio","noAudio","withAudioCodec","audioCodec","withAudioBitrate","audioBitrate","withAudioChannels","audioChannels","channels","withAudioFrequency","audioFrequency","freq","withAudioQuality","audioQuality","quality","withAudioFilter","withAudioFilters","audioFilter","done","updateExe","execPath","detached","argv","quit","check","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","ab","__dirname","BrowserWindow","ipcMain","mainWindow","createWindow","minWidth","minHeight","webPreferences","preload","MAIN_WINDOW_PRELOAD_WEBPACK_ENTRY","contextIsolation","nodeIntegration","loadURL","MAIN_WINDOW_WEBPACK_ENTRY","webContents","openDevTools","handle","filePath","whenReady","then","getAllWindows"],"sourceRoot":""}